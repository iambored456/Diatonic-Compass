var Tn=Object.defineProperty;var xn=(a,t,e)=>t in a?Tn(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var Ur=(a,t,e)=>xn(a,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();const Sn="modulepreload",kn=function(a,t){return new URL(a,t).href},Vr={},Ie=function(t,e,r){let i=Promise.resolve();if(e&&e.length>0){let s=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const o=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=s(e.map(h=>{if(h=kn(h,r),h in Vr)return;Vr[h]=!0;const d=h.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(!!r)for(let u=o.length-1;u>=0;u--){const _=o[u];if(_.href===h&&(!d||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${f}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":Sn,d||(p.as="script"),p.crossOrigin="",p.href=h,c&&p.setAttribute("nonce",c),document.head.appendChild(p),d)return new Promise((u,_)=>{p.addEventListener("load",u),p.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${h}`)))})}))}function n(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return i.then(s=>{for(const o of s||[])o.status==="rejected"&&n(o.reason);return t().catch(n)})},De=["C","C♯/D♭","D","D♯/E♭","E","F","F♯/G♭","G","G♯/A♭","A","A♯/B♭","B"],Re=["1","♯1/♭2","2","♯2/♭3","3","4","♯4/♭5","5","♯5/♭6","6","♯6/♭7","7"],En=[...Array(12).keys()],Tt=12,Le=[0,2,4,5,7,9,11],fe={C:!0,"C♯/D♭":!1,D:!0,"D♯/E♭":!1,E:!0,F:!0,"F♯/G♭":!1,G:!0,"G♯/A♭":!1,A:!0,"A♯/B♭":!1,B:!0},sr={0:"#f090ae",2:"#ea9e5e",4:"#a8bd61",5:"#76c788",7:"#33c6dc",9:"#94adff",11:"#dd95d6",1:"#a46055",3:"#8a722f",6:"#258677",8:"#3d7ca5",10:"#7d68a3"},On={1:[0,2,4,5,7,9,11],2:[0,2,3,5,7,9,10],3:[0,1,3,5,7,8,10],4:[0,2,4,6,7,9,11],5:[0,2,4,5,7,9,10],6:[0,2,3,5,7,8,10],7:[0,1,3,5,6,8,10]},ui={1:"1","♯1/♭2":"2",2:"2","♯2/♭3":"3",3:"3",4:"4","♯4/♭5":"5",5:"5","♯5/♭6":"6",6:"6","♯6/♭7":"7",7:"7"},An={1:"Major",2:"Dorian",3:"Phrygian",4:"Lydian",5:"Mixolydian",6:"Minor",7:"Locrian"},Pn=[2,2,1,2,2,2,1],Vt=Math.PI*2,V=Vt/12,Q={ANIMATION:{DURATION_MS:300},WHEEL:{SEGMENTS:12,FONTS:{OUTER_FACTOR:.057,MIDDLE_FACTOR:.052,INNER_FACTOR:.042}},AUDIO:{BASE_FREQUENCY:261.63,NOTE_DURATION_MS:250,PAUSE_BETWEEN_NOTES_MS:50},ERROR_HANDLING:{CONTEXTS:{AUDIO:"AudioContext",ANIMATION:"Animation",UI:"UI",APP:"App"}}},Mn=Q.WHEEL.FONTS.OUTER_FACTOR,In=Q.WHEEL.FONTS.MIDDLE_FACTOR,Dn=Q.WHEEL.FONTS.INNER_FACTOR,Rn=Q.ANIMATION.DURATION_MS,Wr=Q.AUDIO.NOTE_DURATION_MS,Ln=Q.AUDIO.PAUSE_BETWEEN_NOTES_MS,Bn=Q.AUDIO.BASE_FREQUENCY,m={rings:{pitchClass:0,degree:0,chromatic:0,highlightPosition:0},drag:{active:null,startX:0,startY:0,startPitchClass:0,startDegree:0,startChrom:0,startHighlight:0},animation:null,belts:{itemSize:{},tracks:{},init:!1,orientation:"horizontal",order:["pitch","degree","intervals","chromatic"],layoutOrder:{horizontal:["compass","pitch","degree","intervals","chromatic","result"],vertical:["compass","result"]}},dimensions:{size:0,cx:0,cy:0,dpr:1},playback:{isPlaying:!1,currentNoteIndex:null,sequence:[],timeoutId:null,audioContext:null,rootNoteIndexForPlayback:null},display:{sharp:!0,flat:!0},ui:{sidebarOpen:!1,darkMode:!1,display:{get sharp(){return m.display.sharp},get flat(){return m.display.flat},set sharp(a){m.display.sharp=a},set flat(a){m.display.flat=a}}}},Yr=Object.freeze(Object.defineProperty({__proto__:null,appState:m},Symbol.toStringTag,{value:"Module"}));function Nn(a){function t(e){a(e),requestAnimationFrame(t)}requestAnimationFrame(t)}class E{static handle(t,e,r=null){const i={message:t.message,stack:t.stack,context:e,timestamp:Date.now(),userAgent:navigator.userAgent};if(console.error(`[${e}] Error:`,t),this.logError(i),r)try{r()}catch(n){console.error(`[${e}] Fallback failed:`,n)}this.attemptRecovery(e,t)}static logError(t){try{const e=JSON.parse(sessionStorage.getItem("diatonic-errors")||"[]");e.push(t);const r=e.slice(-20);sessionStorage.setItem("diatonic-errors",JSON.stringify(r))}catch(e){this.isDebugMode&&console.warn("Could not log error to sessionStorage:",e)}}static attemptRecovery(t,e){switch(t){case"AudioContext":this.recoverAudioContext();break;case"Canvas":this.recoverCanvas();break;case"Animation":this.recoverAnimation();break;case"LocalStorage":this.recoverLocalStorage();break;case"Resize":console.warn("Resize error detected - may self-resolve");break;default:this.isDebugMode&&console.warn(`No specific recovery strategy for context: ${t}`)}}static recoverAudioContext(){Ie(async()=>{const{appState:t}=await Promise.resolve().then(()=>Yr);return{appState:t}},void 0,import.meta.url).then(({appState:t})=>{if(t.playback.audioContext){try{t.playback.audioContext.close()}catch{}t.playback.audioContext=null}t.playback.isPlaying&&(t.playback.isPlaying=!1,t.playback.currentNoteIndex=null,t.playback.sequence=[],t.playback.timeoutId&&(clearTimeout(t.playback.timeoutId),t.playback.timeoutId=null))})}static recoverCanvas(){requestAnimationFrame(()=>{console.log("Attempting canvas recovery via redraw")})}static recoverAnimation(){Ie(async()=>{const{appState:t}=await Promise.resolve().then(()=>Yr);return{appState:t}},void 0,import.meta.url).then(({appState:t})=>{t.animation=null,t.drag.active=null})}static recoverLocalStorage(){console.warn("LocalStorage unavailable - preferences will not persist")}static getErrorLog(){try{return JSON.parse(sessionStorage.getItem("diatonic-errors")||"[]")}catch{return[]}}static clearErrorLog(){try{sessionStorage.removeItem("diatonic-errors")}catch{}}static enableDebugMode(){this.isDebugMode=!0,console.log("ErrorHandler debug mode enabled")}static isFeatureSupported(t){switch(t){case"AudioContext":return!!(window.AudioContext||window.webkitAudioContext);case"localStorage":try{const e="__localStorage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}case"requestIdleCallback":return typeof window.requestIdleCallback=="function";case"OffscreenCanvas":return typeof OffscreenCanvas<"u";default:return!0}}static wrap(t,e,r=null){return(...i)=>{try{return t(...i)}catch(n){return this.handle(n,e,r),r?r(...i):void 0}}}}Ur(E,"isDebugMode",!1);function Fn(a,t){try{if(!a)return console.warn("No canvas element provided"),!1;if(!t)return console.warn("No dimensions object provided"),!1;if(!a.parentElement)return!1;const e=a.closest(".main-container"),r=e&&e.classList.contains("vertical-layout"),i=a.parentElement.offsetWidth,n=a.parentElement.offsetHeight,s=window.innerWidth,o=window.innerHeight,l=e?e.offsetWidth:0,c=e?e.offsetHeight:0;let h=a;const d=[];for(;h&&h!==document.body;)d.push({tagName:h.tagName,className:h.className,id:h.id,width:h.offsetWidth,height:h.offsetHeight,style:{width:h.style.width,height:h.style.height,display:getComputedStyle(h).display,position:getComputedStyle(h).position}}),h=h.parentElement;let f;if(r){const u=Math.max(i,s*.4),_=Math.max(n,o*.8);f=Math.min(u,_)}else{const u=Math.min(i,n);f=Math.min(u,window.innerHeight*.8)}if(Math.abs(f-(t.size||0))>50&&(console.log("=== CANVAS CONTAINER DEBUG ==="),console.log("Vertical mode:",r),console.log("Canvas size:",{width:a.width,height:a.height}),console.log("Container dimensions:",{containerWidth:i,containerHeight:n}),console.log("Viewport dimensions:",{viewportWidth:s,viewportHeight:o}),console.log("Calculated size:",f),console.log("DOM Hierarchy (from canvas to body):"),d.forEach((u,_)=>{console.log(`  ${_}: ${u.tagName}${u.id?"#"+u.id:""}${u.className?"."+u.className.replace(/\s+/g,"."):""}`,{dimensions:`${u.width}x${u.height}`,styles:u.style})})),f===t.size||f===0||t.size&&Math.abs(f-t.size)<2)return!1;console.log("Canvas resize proceeding:",{oldSize:t.size,newSize:f,difference:Math.abs(f-(t.size||0))}),t.size=f,t.cx=f/2,t.cy=f/2,(!t.dpr||t.dpr===0)&&(t.dpr=zn());const g=f*t.dpr,p=f*t.dpr;return console.log("Setting canvas dimensions:",{cssSize:`${f}px`,bufferSize:`${g}x${p}`,dpr:t.dpr,beforeCSS:{width:a.style.width,height:a.style.height},beforeBuffer:{width:a.width,height:a.height}}),a.width=g,a.height=p,a.style.width=`${f}px`,a.style.height=`${f}px`,console.log("Canvas dimensions after setting:",{cssSize:{width:a.style.width,height:a.style.height},bufferSize:{width:a.width,height:a.height},offsetSize:{width:a.offsetWidth,height:a.offsetHeight}}),!0}catch(e){return E.handle(e,"Canvas",()=>{try{if(a&&a.parentElement&&t){const r=Math.min(a.parentElement.offsetWidth,a.parentElement.offsetHeight);r>0&&r!==t.size&&(t.size=r,t.cx=r/2,t.cy=r/2,t.dpr=t.dpr||1,a.width=r*t.dpr,a.height=r*t.dpr)}}catch{console.error("Canvas resize fallback failed")}}),!1}}function zn(){try{return Math.min(window.devicePixelRatio||1,3)}catch(a){return E.handle(a,"Canvas"),1}}const Hn=1/V,z=a=>(a%Vt+Vt)%Vt;function di(a,t){const e=z(t)-z(a);return e>Math.PI?e-Vt:e<-Math.PI?e+Vt:e}const $n=a=>a<.5?2*a*a:-1+(4-2*a)*a,Be=a=>(Math.round(-z(a)*Hn)%12+12)%12;class Zt{static debounce(t,e){let r;const i=(...n)=>{clearTimeout(r),r=setTimeout(()=>t.apply(this,n),e)};return i.cancel=()=>{clearTimeout(r),r=null},i}static throttle(t,e){let r,i,n;return(...s)=>{r?(clearTimeout(i),i=setTimeout(()=>{Date.now()-n>=e&&(t.apply(this,s),n=Date.now())},e-(Date.now()-n))):(t.apply(this,s),n=Date.now(),r=!0)}}static memoize(t,e=JSON.stringify,r=100){const i=new Map,n=(...s)=>{const o=e(s);if(i.has(o))return i.get(o);const l=t(...s);if(i.size>=r){const c=i.keys().next().value;i.delete(c)}return i.set(o,l),l};return n.clearCache=()=>i.clear(),n.getCacheSize=()=>i.size,n.getCacheStats=()=>({size:i.size,maxSize:r,keys:Array.from(i.keys())}),n}static startMeasure(t){const e=performance.now();return()=>{const i=performance.now()-e;return console.log(`[Performance] ${t}: ${i.toFixed(2)}ms`),i}}static monitor(t,e){return(...r)=>{const i=this.startMeasure(e);try{const n=t(...r);return i(),n}catch(n){throw i(),n}}}static requestOptimizedFrame(t,e={}){return typeof window.requestIdleCallback=="function"?window.requestIdleCallback(t,{timeout:16,...e}):requestAnimationFrame(t)}static cancelOptimizedFrame(t){typeof window.cancelIdleCallback=="function"?window.cancelIdleCallback(t):cancelAnimationFrame(t)}static batchDOMUpdates(t){return new Promise(e=>{requestAnimationFrame(()=>{t(),e()})})}static createFPSMonitor(t,e=60){let r=0,i=performance.now(),n;const s=o=>{if(r++,r%e===0){const l=Math.round(e*1e3/(o-i));t(l),i=o}n=requestAnimationFrame(s)};return n=requestAnimationFrame(s),()=>{n&&(cancelAnimationFrame(n),n=null)}}static prefersReducedMotion(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}static getViewportSize(){return{width:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)}}static isElementVisible(t,e=0){const r=t.getBoundingClientRect(),i=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth;return r.bottom>=e*i&&r.top<=(1-e)*i&&r.right>=e*n&&r.left<=(1-e)*n}static getMemoryInfo(){return performance.memory?{used:Math.round(performance.memory.usedJSHeapSize/1048576),total:Math.round(performance.memory.totalJSHeapSize/1048576),limit:Math.round(performance.memory.jsHeapSizeLimit/1048576)}:null}}function qn([a]){const{sharp:t,flat:e}=a.display;return`${t}-${e}`}function Un([a]){const{sharp:t,flat:e}=a.display,{pitchClass:r,degree:i,chromatic:n}=a.rings,s=Math.round(r*1e3)/1e3,o=Math.round(i*1e3)/1e3,l=Math.round(n*1e3)/1e3;return`${t}-${e}-${s}-${o}-${l}`}function Gr(a,t,e){try{if(!a||!a.includes("/"))return a||"";const[r,i]=a.split("/");return!r||!i?(console.warn(`Invalid label format: ${a}`),a):t&&e?`${r}<br>${i}`:t?r:e?i:`${r}<br>${i}`}catch(r){return E.handle(r,"Logic",()=>{console.warn(`Label processing failed for: ${a}`)}),a||""}}function Vn(a){try{const{sharp:t,flat:e}=a.display;if(typeof t!="boolean"||typeof e!="boolean")throw new Error("Invalid display state - sharp/flat must be booleans");const r=De.map(n=>Gr(n,t,e)),i=Re.map(n=>Gr(n,t,e));if(r.length!==12||i.length!==12)throw new Error("Invalid label array lengths");return{chromaticLabels:r,diatonicLabels:i}}catch(t){return E.handle(t,"Logic",()=>{console.warn("Falling back to default labels")}),{chromaticLabels:De.slice(),diatonicLabels:Re.slice()}}}const fi=Zt.memoize(Vn,qn,50);function Wn(a){try{const{sharp:t,flat:e}=a.display,{pitchClass:r,degree:i,chromatic:n}=a.rings;if(typeof r!="number"||typeof i!="number"||typeof n!="number")throw new Error("Invalid ring state - angles must be numbers");const s=b=>{if(!b.includes("/"))return b;const[v,x]=b.split("/");return t&&e?b:t?v:e?x:v},o=De.map(s),l=z(r-n),c=z(i-n),h=Be(l),d=Be(c);if(h<0||h>=12||d<0||d>=12)throw new Error(`Invalid note indices: root=${h}, mode=${d}`);const f=o[h],g=Re[d],p=ui[g]||null,u=p?An[p]:"...";if(!f||!u)throw new Error("Could not determine pitch or mode name");const _=`${f} ${u}`;return{pitch:f,modeName:u,result:_,rootNoteIndex:h,modeDegreeIndex:d,modeKey:p}}catch(t){return E.handle(t,"Logic",()=>{console.warn("Musical result calculation failed")}),{pitch:"C",modeName:"Major",result:"C Major",rootNoteIndex:0,modeDegreeIndex:0,modeKey:"1"}}}const gi=Zt.memoize(Wn,Un,100);function Yn(a,t){try{if(!a||!t)throw new Error("Invalid state or result element");const e=gi(a);t.textContent!==e.result&&(t.textContent=e.result)}catch(e){E.handle(e,"Logic",()=>{t&&(t.textContent="C Major")})}}function ko(a){try{const t=gi(a),e=fi(a);return{...t,labels:e,angles:{pitchClass:a.rings.pitchClass,degree:a.rings.degree,chromatic:a.rings.chromatic,effectivePitch:z(a.rings.pitchClass-a.rings.chromatic),effectiveDegree:z(a.rings.degree-a.rings.chromatic)},display:{sharp:a.display.sharp,flat:a.display.flat}}}catch(t){return E.handle(t,"Logic"),null}}function Ye(a,t=null){const e=performance.now(),r={fromPitchClass:m.rings.pitchClass,fromDegree:m.rings.degree,fromChrom:m.rings.chromatic,fromHighlight:m.rings.highlightPosition},i={toPitchClass:a.pitchClass??r.fromPitchClass,toDegree:a.degree??r.fromDegree,toChrom:a.chromatic??r.fromChrom,toHighlight:a.highlightPosition??r.fromHighlight};m.animation={t0:e,from:r,to:i,onComplete:t}}function Gn(a){const t=m.animation;if(!t)return!1;const e=(a-t.t0)/Rn,r=e>=1?1:$n(e),i=(n,s)=>z(n+di(n,s)*r);return m.rings.pitchClass=i(t.from.fromPitchClass,t.to.toPitchClass),m.rings.degree=i(t.from.fromDegree,t.to.toDegree),m.rings.chromatic=i(t.from.fromChrom,t.to.toChrom),m.rings.highlightPosition=i(t.from.fromHighlight,t.to.toHighlight),r===1&&(t.onComplete&&t.onComplete(),m.animation=null),!0}function pi(a,t){const e=m.rings[a],r=Math.round(-e/V),i=z(-r*V);Ye({[a]:i},t)}function _i(a){const{degree:t,chromatic:e}=m.rings,r=z(t-e),i=z(-r)/V;let n=Le[0],s=1/0;Le.forEach(c=>{const h=Math.abs(i-c),d=Math.min(h,12-h);d<s&&(s=d,n=c)});const o=z(-n*V),l=z(o+e);Ye({degree:l,highlightPosition:l},a)}function mi(a){const t=Math.round(-m.rings.chromatic/V),e=z(-t*V),r=di(m.rings.chromatic,e),i=z(m.rings.pitchClass+r),n=z(m.rings.degree-m.rings.chromatic),s=z(n+e);Ye({pitchClass:i,degree:s,chromatic:e,highlightPosition:s},a)}function yi(){try{if(m.playback.audioContext)return m.playback.audioContext.state==="suspended"?m.playback.audioContext.resume().catch(t=>{E.handle(t,"AudioContext",()=>{m.playback.audioContext=null,yi()})}):Promise.resolve();if(!E.isFeatureSupported("AudioContext"))return console.warn("Web Audio API not supported - audio playback disabled"),Promise.resolve();const a=window.AudioContext||window.webkitAudioContext;return m.playback.audioContext=new a,m.playback.audioContext.addEventListener("statechange",()=>{if(!m.playback.audioContext)return;const t=m.playback.audioContext.state;console.log(`Audio context state changed to: ${t}`),(t==="interrupted"||t==="suspended")&&setTimeout(()=>{var e;((e=m.playback.audioContext)==null?void 0:e.state)==="suspended"&&m.playback.audioContext.resume().catch(r=>{E.handle(r,"AudioContext")})},100)}),m.playback.audioContext.state==="suspended"?m.playback.audioContext.resume().catch(t=>{E.handle(t,"AudioContext",()=>{console.warn("Could not resume audio context - user interaction may be required")})}):Promise.resolve()}catch(a){return E.handle(a,"AudioContext",()=>{console.warn("Audio initialization failed - continuing without audio"),m.playback.audioContext=null}),Promise.resolve()}}function Xn(a,t){try{const e=m.playback.audioContext;if(!e){console.warn("No audio context available");return}if(e.state==="closed"){console.warn("Audio context is closed");return}if(typeof a!="number"||a<0)throw new Error(`Invalid chromatic index: ${a}`);typeof t!="number"||t<=0;const r=e.createOscillator(),i=e.createGain(),n=a%12,s=Math.floor(a/12),o=Bn*Math.pow(2,n/12+s);if(o<20||o>2e4)throw new Error(`Frequency out of audible range: ${o}Hz`);r.frequency.setValueAtTime(o,e.currentTime),r.type="sine",r.connect(i),i.connect(e.destination);const l=e.currentTime,c=.01,h=Math.min(.1,t*.3);i.gain.setValueAtTime(0,l),i.gain.linearRampToValueAtTime(.3,l+c),i.gain.setValueAtTime(.3,l+t-h),i.gain.linearRampToValueAtTime(0,l+t),r.start(l),r.stop(l+t),r.addEventListener("ended",()=>{try{r.disconnect(),i.disconnect()}catch{}}),r.addEventListener("error",d=>{E.handle(new Error("Oscillator error"),"AudioContext")})}catch(e){E.handle(e,"AudioContext",()=>{console.warn(`Failed to play note ${a} - continuing silently`)})}}function Kn(){const{pitchClass:a,degree:t,chromatic:e}=m.rings,r=Be(z(a-e)),i=Be(z(t-e)),n=Re[i],s=ui[n];if(!s)return[];const l=On[s].map(c=>r+c);return l.push(l[0]+12),l}function bi(){if(!m.playback.isPlaying){or();return}const a=m.playback.sequence;if(a.length===0){or();return}const t=a.shift();m.playback.currentNoteIndex=t,Xn(t,Wr/1e3);const e=setTimeout(bi,Wr+Ln);m.playback.timeoutId=e}function jn(){if(m.playback.isPlaying)return;yi();const a=Kn();a.length!==0&&(m.playback.rootNoteIndexForPlayback=a[0],m.playback.isPlaying=!0,m.playback.sequence=a,bi())}function or(){m.playback.isPlaying&&(clearTimeout(m.playback.timeoutId),m.playback.isPlaying=!1,m.playback.currentNoteIndex=null,m.playback.sequence=[],m.playback.timeoutId=null,m.playback.rootNoteIndexForPlayback=null)}const ar="diatonicCompassPreferences",vi="diatonicCompassPreferencesBackup";function Tr(a){try{if(!a||typeof a!="object")throw new Error("Invalid preferences object");if(!E.isFeatureSupported("localStorage"))return console.warn("localStorage not available - preferences will not persist"),!1;const e={...Ne()||{},...a},r=xr(e),i=JSON.stringify(r);try{localStorage.setItem(vi,localStorage.getItem(ar)||"{}")}catch{console.warn("Could not create preferences backup")}return localStorage.setItem(ar,i),!0}catch(t){return E.handle(t,"LocalStorage",()=>{console.warn("Preferences could not be saved - will use session defaults")}),!1}}function Ne(){try{if(!E.isFeatureSupported("localStorage"))return Fe();const a=localStorage.getItem(ar);if(!a)return null;const t=JSON.parse(a),e=xr(t);return JSON.stringify(e)!==a&&(console.log("Preferences were corrected during load - saving updated version"),Tr(e)),e}catch(a){return E.handle(a,"LocalStorage",()=>{const t=Qn();if(t)return console.log("Loaded preferences from backup"),t}),Fe()}}function Qn(){try{const a=localStorage.getItem(vi);if(a){const t=JSON.parse(a);return xr(t)}}catch{console.warn("Could not load backup preferences")}return null}function xr(a){if(!a||typeof a!="object")return Fe();const t=Fe(),e={};for(const[r,i]of Object.entries(t))if(r in a){const n=a[r],s=typeof i;if(typeof n===s)switch(r){case"darkMode":e[r]=!!n;break;case"orientation":e[r]=["horizontal","vertical"].includes(n)?n:i;break;case"volume":e[r]=Math.max(0,Math.min(1,Number(n)))||i;break;case"tutorialCompleted":e[r]=!!n;break;case"beltOrder":if(Array.isArray(n)){const o=["pitch","degree","intervals","chromatic"];o.every(c=>n.includes(c))&&n.length===o.length?e[r]=[...n]:e[r]=i}else e[r]=i;break;default:e[r]=n}else console.warn(`Invalid type for preference ${r}: expected ${s}, got ${typeof n}`),e[r]=i}else e[r]=i;return e}function Fe(){return{darkMode:!1,orientation:"horizontal",volume:.5,tutorialCompleted:!1,showAdvancedControls:!1,beltOrder:["pitch","degree","intervals","chromatic"]}}const j={toggleAccidental(a){try{if(!["sharp","flat"].includes(a))throw new Error(`Invalid accidental type: ${a}`);const e=!m.display[a],r=a==="sharp"?"flat":"sharp",i=m.display[r];!e&&!i&&(m.display[r]=!0),m.display[a]=e}catch(t){E.handle(t,Q.ERROR_HANDLING.CONTEXTS.UI)}},toggleDarkMode(){try{const a=!m.ui.darkMode;m.ui.darkMode=a,document.body.classList.toggle("dark-mode",a),Tr({darkMode:a})}catch(a){E.handle(a,Q.ERROR_HANDLING.CONTEXTS.UI,()=>{document.body.classList.toggle("dark-mode")})}},togglePlayback(){try{m.playback.isPlaying?or():!m.drag.active&&!m.animation&&jn()}catch(a){E.handle(a,Q.ERROR_HANDLING.CONTEXTS.AUDIO)}},toggleSidebar(a){try{const t=typeof a=="boolean"?a:!m.ui.sidebarOpen;m.ui.sidebarOpen=t}catch(t){E.handle(t,Q.ERROR_HANDLING.CONTEXTS.UI)}},setOrientation(a){try{if(!["horizontal","vertical"].includes(a))throw new Error(`Invalid orientation: ${a}`);if(m.belts.orientation===a)return;m.belts.orientation=a,m.rings.pitchClass=0,m.rings.degree=0,m.rings.chromatic=0,m.rings.highlightPosition=0,m.belts.init=!1;const t=document.querySelector(".main-container");t&&t.classList.toggle("vertical-layout",a==="vertical")}catch(t){E.handle(t,Q.ERROR_HANDLING.CONTEXTS.UI)}},snapTo(a,t){try{Ye(a,t)}catch(e){E.handle(e,Q.ERROR_HANDLING.CONTEXTS.ANIMATION)}},setRingAngle(a,t){try{if(!["pitchClass","degree","chromatic","highlightPosition"].includes(a))throw new Error(`Invalid ring name: ${a}`);if(typeof t!="number"||!isFinite(t))throw new Error(`Invalid angle value: ${t}`);m.rings[a]=t}catch(e){E.handle(e,Q.ERROR_HANDLING.CONTEXTS.UI)}},resetRings(){try{m.rings.pitchClass=0,m.rings.degree=0,m.rings.chromatic=0,m.rings.highlightPosition=0}catch(a){E.handle(a,Q.ERROR_HANDLING.CONTEXTS.UI)}},getStateSummary(){try{return{rings:{...m.rings},ui:{sidebarOpen:m.ui.sidebarOpen,darkMode:m.ui.darkMode,display:{sharp:m.display.sharp,flat:m.display.flat}},belts:{orientation:m.belts.orientation,init:m.belts.init},playback:{isPlaying:m.playback.isPlaying},interaction:{isDragging:!!m.drag.active,isAnimating:!!m.animation}}}catch(a){return E.handle(a,Q.ERROR_HANDLING.CONTEXTS.APP),null}}};function xt(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function wi(a,t){a.prototype=Object.create(t.prototype),a.prototype.constructor=a,a.__proto__=t}/*!
 * GSAP 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var ht={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},oe={duration:.5,overwrite:!1,delay:0},Sr,K,H,gt=1e8,D=1/gt,lr=Math.PI*2,Jn=lr/4,Zn=0,Ci=Math.sqrt,ts=Math.cos,es=Math.sin,X=function(t){return typeof t=="string"},U=function(t){return typeof t=="function"},kt=function(t){return typeof t=="number"},kr=function(t){return typeof t>"u"},wt=function(t){return typeof t=="object"},rt=function(t){return t!==!1},Er=function(){return typeof window<"u"},Oe=function(t){return U(t)||X(t)},Ti=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Z=Array.isArray,cr=/(?:-?\.?\d|\.)+/gi,xi=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,te=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,je=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Si=/[+-]=-?[.\d]+/,ki=/[^,'"\[\]\s]+/gi,rs=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,$,yt,hr,Or,ut={},ze={},Ei,Oi=function(t){return(ze=ae(t,ut))&&ot},Ar=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},be=function(t,e){return!e&&console.warn(t)},Ai=function(t,e){return t&&(ut[t]=e)&&ze&&(ze[t]=e)||ut},ve=function(){return 0},is={suppressEvents:!0,isStart:!0,kill:!1},Ae={suppressEvents:!0,kill:!1},ns={suppressEvents:!0},Pr={},Dt=[],ur={},Pi,at={},Qe={},Xr=30,Pe=[],Mr="",Ir=function(t){var e=t[0],r,i;if(wt(e)||U(e)||(t=[t]),!(r=(e._gsap||{}).harness)){for(i=Pe.length;i--&&!Pe[i].targetTest(e););r=Pe[i]}for(i=t.length;i--;)t[i]&&(t[i]._gsap||(t[i]._gsap=new tn(t[i],r)))||t.splice(i,1);return t},Wt=function(t){return t._gsap||Ir(pt(t))[0]._gsap},Mi=function(t,e,r){return(r=t[e])&&U(r)?t[e]():kr(r)&&t.getAttribute&&t.getAttribute(e)||r},it=function(t,e){return(t=t.split(",")).forEach(e)||t},W=function(t){return Math.round(t*1e5)/1e5||0},G=function(t){return Math.round(t*1e7)/1e7||0},re=function(t,e){var r=e.charAt(0),i=parseFloat(e.substr(2));return t=parseFloat(t),r==="+"?t+i:r==="-"?t-i:r==="*"?t*i:t/i},ss=function(t,e){for(var r=e.length,i=0;t.indexOf(e[i])<0&&++i<r;);return i<r},He=function(){var t=Dt.length,e=Dt.slice(0),r,i;for(ur={},Dt.length=0,r=0;r<t;r++)i=e[r],i&&i._lazy&&(i.render(i._lazy[0],i._lazy[1],!0)._lazy=0)},Dr=function(t){return!!(t._initted||t._startAt||t.add)},Ii=function(t,e,r,i){Dt.length&&!K&&He(),t.render(e,r,!!(K&&e<0&&Dr(t))),Dt.length&&!K&&He()},Di=function(t){var e=parseFloat(t);return(e||e===0)&&(t+"").match(ki).length<2?e:X(t)?t.trim():t},Ri=function(t){return t},dt=function(t,e){for(var r in e)r in t||(t[r]=e[r]);return t},os=function(t){return function(e,r){for(var i in r)i in e||i==="duration"&&t||i==="ease"||(e[i]=r[i])}},ae=function(t,e){for(var r in e)t[r]=e[r];return t},Kr=function a(t,e){for(var r in e)r!=="__proto__"&&r!=="constructor"&&r!=="prototype"&&(t[r]=wt(e[r])?a(t[r]||(t[r]={}),e[r]):e[r]);return t},$e=function(t,e){var r={},i;for(i in t)i in e||(r[i]=t[i]);return r},_e=function(t){var e=t.parent||$,r=t.keyframes?os(Z(t.keyframes)):dt;if(rt(t.inherit))for(;e;)r(t,e.vars.defaults),e=e.parent||e._dp;return t},as=function(t,e){for(var r=t.length,i=r===e.length;i&&r--&&t[r]===e[r];);return r<0},Li=function(t,e,r,i,n){var s=t[i],o;if(n)for(o=e[n];s&&s[n]>o;)s=s._prev;return s?(e._next=s._next,s._next=e):(e._next=t[r],t[r]=e),e._next?e._next._prev=e:t[i]=e,e._prev=s,e.parent=e._dp=t,e},Ge=function(t,e,r,i){r===void 0&&(r="_first"),i===void 0&&(i="_last");var n=e._prev,s=e._next;n?n._next=s:t[r]===e&&(t[r]=s),s?s._prev=n:t[i]===e&&(t[i]=n),e._next=e._prev=e.parent=null},Lt=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},Yt=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var r=t;r;)r._dirty=1,r=r.parent;return t},ls=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},dr=function(t,e,r,i){return t._startAt&&(K?t._startAt.revert(Ae):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,i))},cs=function a(t){return!t||t._ts&&a(t.parent)},jr=function(t){return t._repeat?le(t._tTime,t=t.duration()+t._rDelay)*t:0},le=function(t,e){var r=Math.floor(t=G(t/e));return t&&r===t?r-1:r},qe=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},Xe=function(t){return t._end=G(t._start+(t._tDur/Math.abs(t._ts||t._rts||D)||0))},Ke=function(t,e){var r=t._dp;return r&&r.smoothChildTiming&&t._ts&&(t._start=G(r._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),Xe(t),r._dirty||Yt(r,t)),t},Bi=function(t,e){var r;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(r=qe(t.rawTime(),e),(!e._dur||ke(0,e.totalDuration(),r)-e._tTime>D)&&e.render(r,!0)),Yt(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(r=t;r._dp;)r.rawTime()>=0&&r.totalTime(r._tTime),r=r._dp;t._zTime=-D}},bt=function(t,e,r,i){return e.parent&&Lt(e),e._start=G((kt(r)?r:r||t!==$?ft(t,r,e):t._time)+e._delay),e._end=G(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),Li(t,e,"_first","_last",t._sort?"_start":0),fr(e)||(t._recent=e),i||Bi(t,e),t._ts<0&&Ke(t,t._tTime),t},Ni=function(t,e){return(ut.ScrollTrigger||Ar("scrollTrigger",e))&&ut.ScrollTrigger.create(e,t)},Fi=function(t,e,r,i,n){if(Lr(t,e,n),!t._initted)return 1;if(!r&&t._pt&&!K&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&Pi!==lt.frame)return Dt.push(t),t._lazy=[n,i],1},hs=function a(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||a(e))},fr=function(t){var e=t.data;return e==="isFromStart"||e==="isStart"},us=function(t,e,r,i){var n=t.ratio,s=e<0||!e&&(!t._start&&hs(t)&&!(!t._initted&&fr(t))||(t._ts<0||t._dp._ts<0)&&!fr(t))?0:1,o=t._rDelay,l=0,c,h,d;if(o&&t._repeat&&(l=ke(0,t._tDur,e),h=le(l,o),t._yoyo&&h&1&&(s=1-s),h!==le(t._tTime,o)&&(n=1-s,t.vars.repeatRefresh&&t._initted&&t.invalidate())),s!==n||K||i||t._zTime===D||!e&&t._zTime){if(!t._initted&&Fi(t,e,i,r,l))return;for(d=t._zTime,t._zTime=e||(r?D:0),r||(r=e&&!d),t.ratio=s,t._from&&(s=1-s),t._time=0,t._tTime=l,c=t._pt;c;)c.r(s,c.d),c=c._next;e<0&&dr(t,e,r,!0),t._onUpdate&&!r&&ct(t,"onUpdate"),l&&t._repeat&&!r&&t.parent&&ct(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===s&&(s&&Lt(t,1),!r&&!K&&(ct(t,s?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)},ds=function(t,e,r){var i;if(r>e)for(i=t._first;i&&i._start<=r;){if(i.data==="isPause"&&i._start>e)return i;i=i._next}else for(i=t._last;i&&i._start>=r;){if(i.data==="isPause"&&i._start<e)return i;i=i._prev}},ce=function(t,e,r,i){var n=t._repeat,s=G(e)||0,o=t._tTime/t._tDur;return o&&!i&&(t._time*=s/t._dur),t._dur=s,t._tDur=n?n<0?1e10:G(s*(n+1)+t._rDelay*n):s,o>0&&!i&&Ke(t,t._tTime=t._tDur*o),t.parent&&Xe(t),r||Yt(t.parent,t),t},Qr=function(t){return t instanceof tt?Yt(t):ce(t,t._dur)},fs={_start:0,endTime:ve,totalDuration:ve},ft=function a(t,e,r){var i=t.labels,n=t._recent||fs,s=t.duration()>=gt?n.endTime(!1):t._dur,o,l,c;return X(e)&&(isNaN(e)||e in i)?(l=e.charAt(0),c=e.substr(-1)==="%",o=e.indexOf("="),l==="<"||l===">"?(o>=0&&(e=e.replace(/=/,"")),(l==="<"?n._start:n.endTime(n._repeat>=0))+(parseFloat(e.substr(1))||0)*(c?(o<0?n:r).totalDuration()/100:1)):o<0?(e in i||(i[e]=s),i[e]):(l=parseFloat(e.charAt(o-1)+e.substr(o+1)),c&&r&&(l=l/100*(Z(r)?r[0]:r).totalDuration()),o>1?a(t,e.substr(0,o-1),r)+l:s+l)):e==null?s:+e},me=function(t,e,r){var i=kt(e[1]),n=(i?2:1)+(t<2?0:1),s=e[n],o,l;if(i&&(s.duration=e[1]),s.parent=r,t){for(o=s,l=r;l&&!("immediateRender"in o);)o=l.vars.defaults||{},l=rt(l.vars.inherit)&&l.parent;s.immediateRender=rt(o.immediateRender),t<2?s.runBackwards=1:s.startAt=e[n-1]}return new Y(e[0],s,e[n+1])},Nt=function(t,e){return t||t===0?e(t):e},ke=function(t,e,r){return r<t?t:r>e?e:r},J=function(t,e){return!X(t)||!(e=rs.exec(t))?"":e[1]},gs=function(t,e,r){return Nt(r,function(i){return ke(t,e,i)})},gr=[].slice,zi=function(t,e){return t&&wt(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&wt(t[0]))&&!t.nodeType&&t!==yt},ps=function(t,e,r){return r===void 0&&(r=[]),t.forEach(function(i){var n;return X(i)&&!e||zi(i,1)?(n=r).push.apply(n,pt(i)):r.push(i)})||r},pt=function(t,e,r){return H&&!e&&H.selector?H.selector(t):X(t)&&!r&&(hr||!he())?gr.call((e||Or).querySelectorAll(t),0):Z(t)?ps(t,r):zi(t)?gr.call(t,0):t?[t]:[]},pr=function(t){return t=pt(t)[0]||be("Invalid scope")||{},function(e){var r=t.current||t.nativeElement||t;return pt(e,r.querySelectorAll?r:r===t?be("Invalid scope")||Or.createElement("div"):t)}},Hi=function(t){return t.sort(function(){return .5-Math.random()})},$i=function(t){if(U(t))return t;var e=wt(t)?t:{each:t},r=Gt(e.ease),i=e.from||0,n=parseFloat(e.base)||0,s={},o=i>0&&i<1,l=isNaN(i)||o,c=e.axis,h=i,d=i;return X(i)?h=d={center:.5,edges:.5,end:1}[i]||0:!o&&l&&(h=i[0],d=i[1]),function(f,g,p){var u=(p||e).length,_=s[u],b,v,x,k,y,C,T,S,w;if(!_){if(w=e.grid==="auto"?0:(e.grid||[1,gt])[1],!w){for(T=-gt;T<(T=p[w++].getBoundingClientRect().left)&&w<u;);w<u&&w--}for(_=s[u]=[],b=l?Math.min(w,u)*h-.5:i%w,v=w===gt?0:l?u*d/w-.5:i/w|0,T=0,S=gt,C=0;C<u;C++)x=C%w-b,k=v-(C/w|0),_[C]=y=c?Math.abs(c==="y"?k:x):Ci(x*x+k*k),y>T&&(T=y),y<S&&(S=y);i==="random"&&Hi(_),_.max=T-S,_.min=S,_.v=u=(parseFloat(e.amount)||parseFloat(e.each)*(w>u?u-1:c?c==="y"?u/w:w:Math.max(w,u/w))||0)*(i==="edges"?-1:1),_.b=u<0?n-u:n,_.u=J(e.amount||e.each)||0,r=r&&u<0?Qi(r):r}return u=(_[f]-_.min)/_.max||0,G(_.b+(r?r(u):u)*_.v)+_.u}},_r=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(r){var i=G(Math.round(parseFloat(r)/t)*t*e);return(i-i%1)/e+(kt(r)?0:J(r))}},qi=function(t,e){var r=Z(t),i,n;return!r&&wt(t)&&(i=r=t.radius||gt,t.values?(t=pt(t.values),(n=!kt(t[0]))&&(i*=i)):t=_r(t.increment)),Nt(e,r?U(t)?function(s){return n=t(s),Math.abs(n-s)<=i?n:s}:function(s){for(var o=parseFloat(n?s.x:s),l=parseFloat(n?s.y:0),c=gt,h=0,d=t.length,f,g;d--;)n?(f=t[d].x-o,g=t[d].y-l,f=f*f+g*g):f=Math.abs(t[d]-o),f<c&&(c=f,h=d);return h=!i||c<=i?t[h]:s,n||h===s||kt(s)?h:h+J(s)}:_r(t))},Ui=function(t,e,r,i){return Nt(Z(t)?!e:r===!0?!!(r=0):!i,function(){return Z(t)?t[~~(Math.random()*t.length)]:(r=r||1e-5)&&(i=r<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((t-r/2+Math.random()*(e-t+r*.99))/r)*r*i)/i})},_s=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(i){return e.reduce(function(n,s){return s(n)},i)}},ms=function(t,e){return function(r){return t(parseFloat(r))+(e||J(r))}},ys=function(t,e,r){return Wi(t,e,0,1,r)},Vi=function(t,e,r){return Nt(r,function(i){return t[~~e(i)]})},bs=function a(t,e,r){var i=e-t;return Z(t)?Vi(t,a(0,t.length),e):Nt(r,function(n){return(i+(n-t)%i)%i+t})},vs=function a(t,e,r){var i=e-t,n=i*2;return Z(t)?Vi(t,a(0,t.length-1),e):Nt(r,function(s){return s=(n+(s-t)%n)%n||0,t+(s>i?n-s:s)})},we=function(t){for(var e=0,r="",i,n,s,o;~(i=t.indexOf("random(",e));)s=t.indexOf(")",i),o=t.charAt(i+7)==="[",n=t.substr(i+7,s-i-7).match(o?ki:cr),r+=t.substr(e,i-e)+Ui(o?n:+n[0],o?0:+n[1],+n[2]||1e-5),e=s+1;return r+t.substr(e,t.length-e)},Wi=function(t,e,r,i,n){var s=e-t,o=i-r;return Nt(n,function(l){return r+((l-t)/s*o||0)})},ws=function a(t,e,r,i){var n=isNaN(t+e)?0:function(g){return(1-g)*t+g*e};if(!n){var s=X(t),o={},l,c,h,d,f;if(r===!0&&(i=1)&&(r=null),s)t={p:t},e={p:e};else if(Z(t)&&!Z(e)){for(h=[],d=t.length,f=d-2,c=1;c<d;c++)h.push(a(t[c-1],t[c]));d--,n=function(p){p*=d;var u=Math.min(f,~~p);return h[u](p-u)},r=e}else i||(t=ae(Z(t)?[]:{},t));if(!h){for(l in e)Rr.call(o,t,l,"get",e[l]);n=function(p){return Fr(p,o)||(s?t.p:t)}}}return Nt(r,n)},Jr=function(t,e,r){var i=t.labels,n=gt,s,o,l;for(s in i)o=i[s]-e,o<0==!!r&&o&&n>(o=Math.abs(o))&&(l=s,n=o);return l},ct=function(t,e,r){var i=t.vars,n=i[e],s=H,o=t._ctx,l,c,h;if(n)return l=i[e+"Params"],c=i.callbackScope||t,r&&Dt.length&&He(),o&&(H=o),h=l?n.apply(c,l):n.call(c),H=s,h},ge=function(t){return Lt(t),t.scrollTrigger&&t.scrollTrigger.kill(!!K),t.progress()<1&&ct(t,"onInterrupt"),t},ee,Yi=[],Gi=function(t){if(t)if(t=!t.name&&t.default||t,Er()||t.headless){var e=t.name,r=U(t),i=e&&!r&&t.init?function(){this._props=[]}:t,n={init:ve,render:Fr,add:Rr,kill:Ns,modifier:Bs,rawVars:0},s={targetTest:0,get:0,getSetter:Nr,aliases:{},register:0};if(he(),t!==i){if(at[e])return;dt(i,dt($e(t,n),s)),ae(i.prototype,ae(n,$e(t,s))),at[i.prop=e]=i,t.targetTest&&(Pe.push(i),Pr[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Ai(e,i),t.register&&t.register(ot,i,nt)}else Yi.push(t)},I=255,pe={aqua:[0,I,I],lime:[0,I,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,I],navy:[0,0,128],white:[I,I,I],olive:[128,128,0],yellow:[I,I,0],orange:[I,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[I,0,0],pink:[I,192,203],cyan:[0,I,I],transparent:[I,I,I,0]},Je=function(t,e,r){return t+=t<0?1:t>1?-1:0,(t*6<1?e+(r-e)*t*6:t<.5?r:t*3<2?e+(r-e)*(2/3-t)*6:e)*I+.5|0},Xi=function(t,e,r){var i=t?kt(t)?[t>>16,t>>8&I,t&I]:0:pe.black,n,s,o,l,c,h,d,f,g,p;if(!i){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),pe[t])i=pe[t];else if(t.charAt(0)==="#"){if(t.length<6&&(n=t.charAt(1),s=t.charAt(2),o=t.charAt(3),t="#"+n+n+s+s+o+o+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return i=parseInt(t.substr(1,6),16),[i>>16,i>>8&I,i&I,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),i=[t>>16,t>>8&I,t&I]}else if(t.substr(0,3)==="hsl"){if(i=p=t.match(cr),!e)l=+i[0]%360/360,c=+i[1]/100,h=+i[2]/100,s=h<=.5?h*(c+1):h+c-h*c,n=h*2-s,i.length>3&&(i[3]*=1),i[0]=Je(l+1/3,n,s),i[1]=Je(l,n,s),i[2]=Je(l-1/3,n,s);else if(~t.indexOf("="))return i=t.match(xi),r&&i.length<4&&(i[3]=1),i}else i=t.match(cr)||pe.transparent;i=i.map(Number)}return e&&!p&&(n=i[0]/I,s=i[1]/I,o=i[2]/I,d=Math.max(n,s,o),f=Math.min(n,s,o),h=(d+f)/2,d===f?l=c=0:(g=d-f,c=h>.5?g/(2-d-f):g/(d+f),l=d===n?(s-o)/g+(s<o?6:0):d===s?(o-n)/g+2:(n-s)/g+4,l*=60),i[0]=~~(l+.5),i[1]=~~(c*100+.5),i[2]=~~(h*100+.5)),r&&i.length<4&&(i[3]=1),i},Ki=function(t){var e=[],r=[],i=-1;return t.split(Rt).forEach(function(n){var s=n.match(te)||[];e.push.apply(e,s),r.push(i+=s.length+1)}),e.c=r,e},Zr=function(t,e,r){var i="",n=(t+i).match(Rt),s=e?"hsla(":"rgba(",o=0,l,c,h,d;if(!n)return t;if(n=n.map(function(f){return(f=Xi(f,e,1))&&s+(e?f[0]+","+f[1]+"%,"+f[2]+"%,"+f[3]:f.join(","))+")"}),r&&(h=Ki(t),l=r.c,l.join(i)!==h.c.join(i)))for(c=t.replace(Rt,"1").split(te),d=c.length-1;o<d;o++)i+=c[o]+(~l.indexOf(o)?n.shift()||s+"0,0,0,0)":(h.length?h:n.length?n:r).shift());if(!c)for(c=t.split(Rt),d=c.length-1;o<d;o++)i+=c[o]+n[o];return i+c[d]},Rt=function(){var a="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in pe)a+="|"+t+"\\b";return new RegExp(a+")","gi")}(),Cs=/hsl[a]?\(/,ji=function(t){var e=t.join(" "),r;if(Rt.lastIndex=0,Rt.test(e))return r=Cs.test(e),t[1]=Zr(t[1],r),t[0]=Zr(t[0],r,Ki(t[1])),!0},Ce,lt=function(){var a=Date.now,t=500,e=33,r=a(),i=r,n=1e3/240,s=n,o=[],l,c,h,d,f,g,p=function u(_){var b=a()-i,v=_===!0,x,k,y,C;if((b>t||b<0)&&(r+=b-e),i+=b,y=i-r,x=y-s,(x>0||v)&&(C=++d.frame,f=y-d.time*1e3,d.time=y=y/1e3,s+=x+(x>=n?4:n-x),k=1),v||(l=c(u)),k)for(g=0;g<o.length;g++)o[g](y,f,C,_)};return d={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(_){return f/(1e3/(_||60))},wake:function(){Ei&&(!hr&&Er()&&(yt=hr=window,Or=yt.document||{},ut.gsap=ot,(yt.gsapVersions||(yt.gsapVersions=[])).push(ot.version),Oi(ze||yt.GreenSockGlobals||!yt.gsap&&yt||{}),Yi.forEach(Gi)),h=typeof requestAnimationFrame<"u"&&requestAnimationFrame,l&&d.sleep(),c=h||function(_){return setTimeout(_,s-d.time*1e3+1|0)},Ce=1,p(2))},sleep:function(){(h?cancelAnimationFrame:clearTimeout)(l),Ce=0,c=ve},lagSmoothing:function(_,b){t=_||1/0,e=Math.min(b||33,t)},fps:function(_){n=1e3/(_||240),s=d.time*1e3+n},add:function(_,b,v){var x=b?function(k,y,C,T){_(k,y,C,T),d.remove(x)}:_;return d.remove(_),o[v?"unshift":"push"](x),he(),x},remove:function(_,b){~(b=o.indexOf(_))&&o.splice(b,1)&&g>=b&&g--},_listeners:o},d}(),he=function(){return!Ce&&lt.wake()},P={},Ts=/^[\d.\-M][\d.\-,\s]/,xs=/["']/g,Ss=function(t){for(var e={},r=t.substr(1,t.length-3).split(":"),i=r[0],n=1,s=r.length,o,l,c;n<s;n++)l=r[n],o=n!==s-1?l.lastIndexOf(","):l.length,c=l.substr(0,o),e[i]=isNaN(c)?c.replace(xs,"").trim():+c,i=l.substr(o+1).trim();return e},ks=function(t){var e=t.indexOf("(")+1,r=t.indexOf(")"),i=t.indexOf("(",e);return t.substring(e,~i&&i<r?t.indexOf(")",r+1):r)},Es=function(t){var e=(t+"").split("("),r=P[e[0]];return r&&e.length>1&&r.config?r.config.apply(null,~t.indexOf("{")?[Ss(e[1])]:ks(t).split(",").map(Di)):P._CE&&Ts.test(t)?P._CE("",t):r},Qi=function(t){return function(e){return 1-t(1-e)}},Ji=function a(t,e){for(var r=t._first,i;r;)r instanceof tt?a(r,e):r.vars.yoyoEase&&(!r._yoyo||!r._repeat)&&r._yoyo!==e&&(r.timeline?a(r.timeline,e):(i=r._ease,r._ease=r._yEase,r._yEase=i,r._yoyo=e)),r=r._next},Gt=function(t,e){return t&&(U(t)?t:P[t]||Es(t))||e},Qt=function(t,e,r,i){r===void 0&&(r=function(l){return 1-e(1-l)}),i===void 0&&(i=function(l){return l<.5?e(l*2)/2:1-e((1-l)*2)/2});var n={easeIn:e,easeOut:r,easeInOut:i},s;return it(t,function(o){P[o]=ut[o]=n,P[s=o.toLowerCase()]=r;for(var l in n)P[s+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=P[o+"."+l]=n[l]}),n},Zi=function(t){return function(e){return e<.5?(1-t(1-e*2))/2:.5+t((e-.5)*2)/2}},Ze=function a(t,e,r){var i=e>=1?e:1,n=(r||(t?.3:.45))/(e<1?e:1),s=n/lr*(Math.asin(1/i)||0),o=function(h){return h===1?1:i*Math.pow(2,-10*h)*es((h-s)*n)+1},l=t==="out"?o:t==="in"?function(c){return 1-o(1-c)}:Zi(o);return n=lr/n,l.config=function(c,h){return a(t,c,h)},l},tr=function a(t,e){e===void 0&&(e=1.70158);var r=function(s){return s?--s*s*((e+1)*s+e)+1:0},i=t==="out"?r:t==="in"?function(n){return 1-r(1-n)}:Zi(r);return i.config=function(n){return a(t,n)},i};it("Linear,Quad,Cubic,Quart,Quint,Strong",function(a,t){var e=t<5?t+1:t;Qt(a+",Power"+(e-1),t?function(r){return Math.pow(r,e)}:function(r){return r},function(r){return 1-Math.pow(1-r,e)},function(r){return r<.5?Math.pow(r*2,e)/2:1-Math.pow((1-r)*2,e)/2})});P.Linear.easeNone=P.none=P.Linear.easeIn;Qt("Elastic",Ze("in"),Ze("out"),Ze());(function(a,t){var e=1/t,r=2*e,i=2.5*e,n=function(o){return o<e?a*o*o:o<r?a*Math.pow(o-1.5/t,2)+.75:o<i?a*(o-=2.25/t)*o+.9375:a*Math.pow(o-2.625/t,2)+.984375};Qt("Bounce",function(s){return 1-n(1-s)},n)})(7.5625,2.75);Qt("Expo",function(a){return Math.pow(2,10*(a-1))*a+a*a*a*a*a*a*(1-a)});Qt("Circ",function(a){return-(Ci(1-a*a)-1)});Qt("Sine",function(a){return a===1?1:-ts(a*Jn)+1});Qt("Back",tr("in"),tr("out"),tr());P.SteppedEase=P.steps=ut.SteppedEase={config:function(t,e){t===void 0&&(t=1);var r=1/t,i=t+(e?0:1),n=e?1:0,s=1-D;return function(o){return((i*ke(0,s,o)|0)+n)*r}}};oe.ease=P["quad.out"];it("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(a){return Mr+=a+","+a+"Params,"});var tn=function(t,e){this.id=Zn++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:Mi,this.set=e?e.getSetter:Nr},Te=function(){function a(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,ce(this,+e.duration,1,1),this.data=e.data,H&&(this._ctx=H,H.data.push(this)),Ce||lt.wake()}var t=a.prototype;return t.delay=function(r){return r||r===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+r-this._delay),this._delay=r,this):this._delay},t.duration=function(r){return arguments.length?this.totalDuration(this._repeat>0?r+(r+this._rDelay)*this._repeat:r):this.totalDuration()&&this._dur},t.totalDuration=function(r){return arguments.length?(this._dirty=0,ce(this,this._repeat<0?r:(r-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(r,i){if(he(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(Ke(this,r),!n._dp||n.parent||Bi(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&r<this._tDur||this._ts<0&&r>0||!this._tDur&&!r)&&bt(this._dp,this,this._start-this._delay)}return(this._tTime!==r||!this._dur&&!i||this._initted&&Math.abs(this._zTime)===D||!r&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=r),Ii(this,r,i)),this},t.time=function(r,i){return arguments.length?this.totalTime(Math.min(this.totalDuration(),r+jr(this))%(this._dur+this._rDelay)||(r?this._dur:0),i):this._time},t.totalProgress=function(r,i){return arguments.length?this.totalTime(this.totalDuration()*r,i):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},t.progress=function(r,i){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-r:r)+jr(this),i):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(r,i){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(r-1)*n,i):this._repeat?le(this._tTime,n)+1:1},t.timeScale=function(r,i){if(!arguments.length)return this._rts===-D?0:this._rts;if(this._rts===r)return this;var n=this.parent&&this._ts?qe(this.parent._time,this):this._tTime;return this._rts=+r||0,this._ts=this._ps||r===-D?0:this._rts,this.totalTime(ke(-Math.abs(this._delay),this.totalDuration(),n),i!==!1),Xe(this),ls(this)},t.paused=function(r){return arguments.length?(this._ps!==r&&(this._ps=r,r?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(he(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==D&&(this._tTime-=D)))),this):this._ps},t.startTime=function(r){if(arguments.length){this._start=r;var i=this.parent||this._dp;return i&&(i._sort||!this.parent)&&bt(i,this,r-this._delay),this}return this._start},t.endTime=function(r){return this._start+(rt(r)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(r){var i=this.parent||this._dp;return i?r&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?qe(i.rawTime(r),this):this._tTime:this._tTime},t.revert=function(r){r===void 0&&(r=ns);var i=K;return K=r,Dr(this)&&(this.timeline&&this.timeline.revert(r),this.totalTime(-.01,r.suppressEvents)),this.data!=="nested"&&r.kill!==!1&&this.kill(),K=i,this},t.globalTime=function(r){for(var i=this,n=arguments.length?r:i.rawTime();i;)n=i._start+n/(Math.abs(i._ts)||1),i=i._dp;return!this.parent&&this._sat?this._sat.globalTime(r):n},t.repeat=function(r){return arguments.length?(this._repeat=r===1/0?-2:r,Qr(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(r){if(arguments.length){var i=this._time;return this._rDelay=r,Qr(this),i?this.time(i):this}return this._rDelay},t.yoyo=function(r){return arguments.length?(this._yoyo=r,this):this._yoyo},t.seek=function(r,i){return this.totalTime(ft(this,r),rt(i))},t.restart=function(r,i){return this.play().totalTime(r?-this._delay:0,rt(i)),this._dur||(this._zTime=-D),this},t.play=function(r,i){return r!=null&&this.seek(r,i),this.reversed(!1).paused(!1)},t.reverse=function(r,i){return r!=null&&this.seek(r||this.totalDuration(),i),this.reversed(!0).paused(!1)},t.pause=function(r,i){return r!=null&&this.seek(r,i),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(r){return arguments.length?(!!r!==this.reversed()&&this.timeScale(-this._rts||(r?-D:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-D,this},t.isActive=function(){var r=this.parent||this._dp,i=this._start,n;return!!(!r||this._ts&&this._initted&&r.isActive()&&(n=r.rawTime(!0))>=i&&n<this.endTime(!0)-D)},t.eventCallback=function(r,i,n){var s=this.vars;return arguments.length>1?(i?(s[r]=i,n&&(s[r+"Params"]=n),r==="onUpdate"&&(this._onUpdate=i)):delete s[r],this):s[r]},t.then=function(r){var i=this;return new Promise(function(n){var s=U(r)?r:Ri,o=function(){var c=i.then;i.then=null,U(s)&&(s=s(i))&&(s.then||s===i)&&(i.then=c),n(s),i.then=c};i._initted&&i.totalProgress()===1&&i._ts>=0||!i._tTime&&i._ts<0?o():i._prom=o})},t.kill=function(){ge(this)},a}();dt(Te.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-D,_prom:0,_ps:!1,_rts:1});var tt=function(a){wi(t,a);function t(r,i){var n;return r===void 0&&(r={}),n=a.call(this,r)||this,n.labels={},n.smoothChildTiming=!!r.smoothChildTiming,n.autoRemoveChildren=!!r.autoRemoveChildren,n._sort=rt(r.sortChildren),$&&bt(r.parent||$,xt(n),i),r.reversed&&n.reverse(),r.paused&&n.paused(!0),r.scrollTrigger&&Ni(xt(n),r.scrollTrigger),n}var e=t.prototype;return e.to=function(i,n,s){return me(0,arguments,this),this},e.from=function(i,n,s){return me(1,arguments,this),this},e.fromTo=function(i,n,s,o){return me(2,arguments,this),this},e.set=function(i,n,s){return n.duration=0,n.parent=this,_e(n).repeatDelay||(n.repeat=0),n.immediateRender=!!n.immediateRender,new Y(i,n,ft(this,s),1),this},e.call=function(i,n,s){return bt(this,Y.delayedCall(0,i,n),s)},e.staggerTo=function(i,n,s,o,l,c,h){return s.duration=n,s.stagger=s.stagger||o,s.onComplete=c,s.onCompleteParams=h,s.parent=this,new Y(i,s,ft(this,l)),this},e.staggerFrom=function(i,n,s,o,l,c,h){return s.runBackwards=1,_e(s).immediateRender=rt(s.immediateRender),this.staggerTo(i,n,s,o,l,c,h)},e.staggerFromTo=function(i,n,s,o,l,c,h,d){return o.startAt=s,_e(o).immediateRender=rt(o.immediateRender),this.staggerTo(i,n,o,l,c,h,d)},e.render=function(i,n,s){var o=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,h=i<=0?0:G(i),d=this._zTime<0!=i<0&&(this._initted||!c),f,g,p,u,_,b,v,x,k,y,C,T;if(this!==$&&h>l&&i>=0&&(h=l),h!==this._tTime||s||d){if(o!==this._time&&c&&(h+=this._time-o,i+=this._time-o),f=h,k=this._start,x=this._ts,b=!x,d&&(c||(o=this._zTime),(i||!n)&&(this._zTime=i)),this._repeat){if(C=this._yoyo,_=c+this._rDelay,this._repeat<-1&&i<0)return this.totalTime(_*100+i,n,s);if(f=G(h%_),h===l?(u=this._repeat,f=c):(y=G(h/_),u=~~y,u&&u===y&&(f=c,u--),f>c&&(f=c)),y=le(this._tTime,_),!o&&this._tTime&&y!==u&&this._tTime-y*_-this._dur<=0&&(y=u),C&&u&1&&(f=c-f,T=1),u!==y&&!this._lock){var S=C&&y&1,w=S===(C&&u&1);if(u<y&&(S=!S),o=S?0:h%c?c:h,this._lock=1,this.render(o||(T?0:G(u*_)),n,!c)._lock=0,this._tTime=h,!n&&this.parent&&ct(this,"onRepeat"),this.vars.repeatRefresh&&!T&&(this.invalidate()._lock=1),o&&o!==this._time||b!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,w&&(this._lock=2,o=S?c:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!T&&this.invalidate()),this._lock=0,!this._ts&&!b)return this;Ji(this,T)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(v=ds(this,G(o),G(f)),v&&(h-=f-(f=v._start))),this._tTime=h,this._time=f,this._act=!x,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=i,o=0),!o&&h&&!n&&!y&&(ct(this,"onStart"),this._tTime!==h))return this;if(f>=o&&i>=0)for(g=this._first;g;){if(p=g._next,(g._act||f>=g._start)&&g._ts&&v!==g){if(g.parent!==this)return this.render(i,n,s);if(g.render(g._ts>0?(f-g._start)*g._ts:(g._dirty?g.totalDuration():g._tDur)+(f-g._start)*g._ts,n,s),f!==this._time||!this._ts&&!b){v=0,p&&(h+=this._zTime=-D);break}}g=p}else{g=this._last;for(var A=i<0?i:f;g;){if(p=g._prev,(g._act||A<=g._end)&&g._ts&&v!==g){if(g.parent!==this)return this.render(i,n,s);if(g.render(g._ts>0?(A-g._start)*g._ts:(g._dirty?g.totalDuration():g._tDur)+(A-g._start)*g._ts,n,s||K&&Dr(g)),f!==this._time||!this._ts&&!b){v=0,p&&(h+=this._zTime=A?-D:D);break}}g=p}}if(v&&!n&&(this.pause(),v.render(f>=o?0:-D)._zTime=f>=o?1:-1,this._ts))return this._start=k,Xe(this),this.render(i,n,s);this._onUpdate&&!n&&ct(this,"onUpdate",!0),(h===l&&this._tTime>=this.totalDuration()||!h&&o)&&(k===this._start||Math.abs(x)!==Math.abs(this._ts))&&(this._lock||((i||!c)&&(h===l&&this._ts>0||!h&&this._ts<0)&&Lt(this,1),!n&&!(i<0&&!o)&&(h||o||!l)&&(ct(this,h===l&&i>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(h<l&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(i,n){var s=this;if(kt(n)||(n=ft(this,n,i)),!(i instanceof Te)){if(Z(i))return i.forEach(function(o){return s.add(o,n)}),this;if(X(i))return this.addLabel(i,n);if(U(i))i=Y.delayedCall(0,i);else return this}return this!==i?bt(this,i,n):this},e.getChildren=function(i,n,s,o){i===void 0&&(i=!0),n===void 0&&(n=!0),s===void 0&&(s=!0),o===void 0&&(o=-gt);for(var l=[],c=this._first;c;)c._start>=o&&(c instanceof Y?n&&l.push(c):(s&&l.push(c),i&&l.push.apply(l,c.getChildren(!0,n,s)))),c=c._next;return l},e.getById=function(i){for(var n=this.getChildren(1,1,1),s=n.length;s--;)if(n[s].vars.id===i)return n[s]},e.remove=function(i){return X(i)?this.removeLabel(i):U(i)?this.killTweensOf(i):(i.parent===this&&Ge(this,i),i===this._recent&&(this._recent=this._last),Yt(this))},e.totalTime=function(i,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=G(lt.time-(this._ts>0?i/this._ts:(this.totalDuration()-i)/-this._ts))),a.prototype.totalTime.call(this,i,n),this._forcing=0,this):this._tTime},e.addLabel=function(i,n){return this.labels[i]=ft(this,n),this},e.removeLabel=function(i){return delete this.labels[i],this},e.addPause=function(i,n,s){var o=Y.delayedCall(0,n||ve,s);return o.data="isPause",this._hasPause=1,bt(this,o,ft(this,i))},e.removePause=function(i){var n=this._first;for(i=ft(this,i);n;)n._start===i&&n.data==="isPause"&&Lt(n),n=n._next},e.killTweensOf=function(i,n,s){for(var o=this.getTweensOf(i,s),l=o.length;l--;)Pt!==o[l]&&o[l].kill(i,n);return this},e.getTweensOf=function(i,n){for(var s=[],o=pt(i),l=this._first,c=kt(n),h;l;)l instanceof Y?ss(l._targets,o)&&(c?(!Pt||l._initted&&l._ts)&&l.globalTime(0)<=n&&l.globalTime(l.totalDuration())>n:!n||l.isActive())&&s.push(l):(h=l.getTweensOf(o,n)).length&&s.push.apply(s,h),l=l._next;return s},e.tweenTo=function(i,n){n=n||{};var s=this,o=ft(s,i),l=n,c=l.startAt,h=l.onStart,d=l.onStartParams,f=l.immediateRender,g,p=Y.to(s,dt({ease:n.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:n.duration||Math.abs((o-(c&&"time"in c?c.time:s._time))/s.timeScale())||D,onStart:function(){if(s.pause(),!g){var _=n.duration||Math.abs((o-(c&&"time"in c?c.time:s._time))/s.timeScale());p._dur!==_&&ce(p,_,0,1).render(p._time,!0,!0),g=1}h&&h.apply(p,d||[])}},n));return f?p.render(0):p},e.tweenFromTo=function(i,n,s){return this.tweenTo(n,dt({startAt:{time:ft(this,i)}},s))},e.recent=function(){return this._recent},e.nextLabel=function(i){return i===void 0&&(i=this._time),Jr(this,ft(this,i))},e.previousLabel=function(i){return i===void 0&&(i=this._time),Jr(this,ft(this,i),1)},e.currentLabel=function(i){return arguments.length?this.seek(i,!0):this.previousLabel(this._time+D)},e.shiftChildren=function(i,n,s){s===void 0&&(s=0);for(var o=this._first,l=this.labels,c;o;)o._start>=s&&(o._start+=i,o._end+=i),o=o._next;if(n)for(c in l)l[c]>=s&&(l[c]+=i);return Yt(this)},e.invalidate=function(i){var n=this._first;for(this._lock=0;n;)n.invalidate(i),n=n._next;return a.prototype.invalidate.call(this,i)},e.clear=function(i){i===void 0&&(i=!0);for(var n=this._first,s;n;)s=n._next,this.remove(n),n=s;return this._dp&&(this._time=this._tTime=this._pTime=0),i&&(this.labels={}),Yt(this)},e.totalDuration=function(i){var n=0,s=this,o=s._last,l=gt,c,h,d;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-i:i));if(s._dirty){for(d=s.parent;o;)c=o._prev,o._dirty&&o.totalDuration(),h=o._start,h>l&&s._sort&&o._ts&&!s._lock?(s._lock=1,bt(s,o,h-o._delay,1)._lock=0):l=h,h<0&&o._ts&&(n-=h,(!d&&!s._dp||d&&d.smoothChildTiming)&&(s._start+=h/s._ts,s._time-=h,s._tTime-=h),s.shiftChildren(-h,!1,-1/0),l=0),o._end>n&&o._ts&&(n=o._end),o=c;ce(s,s===$&&s._time>n?s._time:n,1,1),s._dirty=0}return s._tDur},t.updateRoot=function(i){if($._ts&&(Ii($,qe(i,$)),Pi=lt.frame),lt.frame>=Xr){Xr+=ht.autoSleep||120;var n=$._first;if((!n||!n._ts)&&ht.autoSleep&&lt._listeners.length<2){for(;n&&!n._ts;)n=n._next;n||lt.sleep()}}},t}(Te);dt(tt.prototype,{_lock:0,_hasPause:0,_forcing:0});var Os=function(t,e,r,i,n,s,o){var l=new nt(this._pt,t,e,0,1,an,null,n),c=0,h=0,d,f,g,p,u,_,b,v;for(l.b=r,l.e=i,r+="",i+="",(b=~i.indexOf("random("))&&(i=we(i)),s&&(v=[r,i],s(v,t,e),r=v[0],i=v[1]),f=r.match(je)||[];d=je.exec(i);)p=d[0],u=i.substring(c,d.index),g?g=(g+1)%5:u.substr(-5)==="rgba("&&(g=1),p!==f[h++]&&(_=parseFloat(f[h-1])||0,l._pt={_next:l._pt,p:u||h===1?u:",",s:_,c:p.charAt(1)==="="?re(_,p)-_:parseFloat(p)-_,m:g&&g<4?Math.round:0},c=je.lastIndex);return l.c=c<i.length?i.substring(c,i.length):"",l.fp=o,(Si.test(i)||b)&&(l.e=0),this._pt=l,l},Rr=function(t,e,r,i,n,s,o,l,c,h){U(i)&&(i=i(n||0,t,s));var d=t[e],f=r!=="get"?r:U(d)?c?t[e.indexOf("set")||!U(t["get"+e.substr(3)])?e:"get"+e.substr(3)](c):t[e]():d,g=U(d)?c?Ds:sn:Br,p;if(X(i)&&(~i.indexOf("random(")&&(i=we(i)),i.charAt(1)==="="&&(p=re(f,i)+(J(f)||0),(p||p===0)&&(i=p))),!h||f!==i||mr)return!isNaN(f*i)&&i!==""?(p=new nt(this._pt,t,e,+f||0,i-(f||0),typeof d=="boolean"?Ls:on,0,g),c&&(p.fp=c),o&&p.modifier(o,this,t),this._pt=p):(!d&&!(e in t)&&Ar(e,i),Os.call(this,t,e,f,i,g,l||ht.stringFilter,c))},As=function(t,e,r,i,n){if(U(t)&&(t=ye(t,n,e,r,i)),!wt(t)||t.style&&t.nodeType||Z(t)||Ti(t))return X(t)?ye(t,n,e,r,i):t;var s={},o;for(o in t)s[o]=ye(t[o],n,e,r,i);return s},en=function(t,e,r,i,n,s){var o,l,c,h;if(at[t]&&(o=new at[t]).init(n,o.rawVars?e[t]:As(e[t],i,n,s,r),r,i,s)!==!1&&(r._pt=l=new nt(r._pt,n,t,0,1,o.render,o,0,o.priority),r!==ee))for(c=r._ptLookup[r._targets.indexOf(n)],h=o._props.length;h--;)c[o._props[h]]=l;return o},Pt,mr,Lr=function a(t,e,r){var i=t.vars,n=i.ease,s=i.startAt,o=i.immediateRender,l=i.lazy,c=i.onUpdate,h=i.runBackwards,d=i.yoyoEase,f=i.keyframes,g=i.autoRevert,p=t._dur,u=t._startAt,_=t._targets,b=t.parent,v=b&&b.data==="nested"?b.vars.targets:_,x=t._overwrite==="auto"&&!Sr,k=t.timeline,y,C,T,S,w,A,R,M,O,L,B,N,F;if(k&&(!f||!n)&&(n="none"),t._ease=Gt(n,oe.ease),t._yEase=d?Qi(Gt(d===!0?n:d,oe.ease)):0,d&&t._yoyo&&!t._repeat&&(d=t._yEase,t._yEase=t._ease,t._ease=d),t._from=!k&&!!i.runBackwards,!k||f&&!i.stagger){if(M=_[0]?Wt(_[0]).harness:0,N=M&&i[M.prop],y=$e(i,Pr),u&&(u._zTime<0&&u.progress(1),e<0&&h&&o&&!g?u.render(-1,!0):u.revert(h&&p?Ae:is),u._lazy=0),s){if(Lt(t._startAt=Y.set(_,dt({data:"isStart",overwrite:!1,parent:b,immediateRender:!0,lazy:!u&&rt(l),startAt:null,delay:0,onUpdate:c&&function(){return ct(t,"onUpdate")},stagger:0},s))),t._startAt._dp=0,t._startAt._sat=t,e<0&&(K||!o&&!g)&&t._startAt.revert(Ae),o&&p&&e<=0&&r<=0){e&&(t._zTime=e);return}}else if(h&&p&&!u){if(e&&(o=!1),T=dt({overwrite:!1,data:"isFromStart",lazy:o&&!u&&rt(l),immediateRender:o,stagger:0,parent:b},y),N&&(T[M.prop]=N),Lt(t._startAt=Y.set(_,T)),t._startAt._dp=0,t._startAt._sat=t,e<0&&(K?t._startAt.revert(Ae):t._startAt.render(-1,!0)),t._zTime=e,!o)a(t._startAt,D,D);else if(!e)return}for(t._pt=t._ptCache=0,l=p&&rt(l)||l&&!p,C=0;C<_.length;C++){if(w=_[C],R=w._gsap||Ir(_)[C]._gsap,t._ptLookup[C]=L={},ur[R.id]&&Dt.length&&He(),B=v===_?C:v.indexOf(w),M&&(O=new M).init(w,N||y,t,B,v)!==!1&&(t._pt=S=new nt(t._pt,w,O.name,0,1,O.render,O,0,O.priority),O._props.forEach(function(et){L[et]=S}),O.priority&&(A=1)),!M||N)for(T in y)at[T]&&(O=en(T,y,t,B,w,v))?O.priority&&(A=1):L[T]=S=Rr.call(t,w,T,"get",y[T],B,v,0,i.stringFilter);t._op&&t._op[C]&&t.kill(w,t._op[C]),x&&t._pt&&(Pt=t,$.killTweensOf(w,L,t.globalTime(e)),F=!t.parent,Pt=0),t._pt&&l&&(ur[R.id]=1)}A&&ln(t),t._onInit&&t._onInit(t)}t._onUpdate=c,t._initted=(!t._op||t._pt)&&!F,f&&e<=0&&k.render(gt,!0,!0)},Ps=function(t,e,r,i,n,s,o,l){var c=(t._pt&&t._ptCache||(t._ptCache={}))[e],h,d,f,g;if(!c)for(c=t._ptCache[e]=[],f=t._ptLookup,g=t._targets.length;g--;){if(h=f[g][e],h&&h.d&&h.d._pt)for(h=h.d._pt;h&&h.p!==e&&h.fp!==e;)h=h._next;if(!h)return mr=1,t.vars[e]="+=0",Lr(t,o),mr=0,l?be(e+" not eligible for reset"):1;c.push(h)}for(g=c.length;g--;)d=c[g],h=d._pt||d,h.s=(i||i===0)&&!n?i:h.s+(i||0)+s*h.c,h.c=r-h.s,d.e&&(d.e=W(r)+J(d.e)),d.b&&(d.b=h.s+J(d.b))},Ms=function(t,e){var r=t[0]?Wt(t[0]).harness:0,i=r&&r.aliases,n,s,o,l;if(!i)return e;n=ae({},e);for(s in i)if(s in n)for(l=i[s].split(","),o=l.length;o--;)n[l[o]]=n[s];return n},Is=function(t,e,r,i){var n=e.ease||i||"power1.inOut",s,o;if(Z(e))o=r[t]||(r[t]=[]),e.forEach(function(l,c){return o.push({t:c/(e.length-1)*100,v:l,e:n})});else for(s in e)o=r[s]||(r[s]=[]),s==="ease"||o.push({t:parseFloat(t),v:e[s],e:n})},ye=function(t,e,r,i,n){return U(t)?t.call(e,r,i,n):X(t)&&~t.indexOf("random(")?we(t):t},rn=Mr+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",nn={};it(rn+",id,stagger,delay,duration,paused,scrollTrigger",function(a){return nn[a]=1});var Y=function(a){wi(t,a);function t(r,i,n,s){var o;typeof i=="number"&&(n.duration=i,i=n,n=null),o=a.call(this,s?i:_e(i))||this;var l=o.vars,c=l.duration,h=l.delay,d=l.immediateRender,f=l.stagger,g=l.overwrite,p=l.keyframes,u=l.defaults,_=l.scrollTrigger,b=l.yoyoEase,v=i.parent||$,x=(Z(r)||Ti(r)?kt(r[0]):"length"in i)?[r]:pt(r),k,y,C,T,S,w,A,R;if(o._targets=x.length?Ir(x):be("GSAP target "+r+" not found. https://gsap.com",!ht.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=g,p||f||Oe(c)||Oe(h)){if(i=o.vars,k=o.timeline=new tt({data:"nested",defaults:u||{},targets:v&&v.data==="nested"?v.vars.targets:x}),k.kill(),k.parent=k._dp=xt(o),k._start=0,f||Oe(c)||Oe(h)){if(T=x.length,A=f&&$i(f),wt(f))for(S in f)~rn.indexOf(S)&&(R||(R={}),R[S]=f[S]);for(y=0;y<T;y++)C=$e(i,nn),C.stagger=0,b&&(C.yoyoEase=b),R&&ae(C,R),w=x[y],C.duration=+ye(c,xt(o),y,w,x),C.delay=(+ye(h,xt(o),y,w,x)||0)-o._delay,!f&&T===1&&C.delay&&(o._delay=h=C.delay,o._start+=h,C.delay=0),k.to(w,C,A?A(y,w,x):0),k._ease=P.none;k.duration()?c=h=0:o.timeline=0}else if(p){_e(dt(k.vars.defaults,{ease:"none"})),k._ease=Gt(p.ease||i.ease||"none");var M=0,O,L,B;if(Z(p))p.forEach(function(N){return k.to(x,N,">")}),k.duration();else{C={};for(S in p)S==="ease"||S==="easeEach"||Is(S,p[S],C,p.easeEach);for(S in C)for(O=C[S].sort(function(N,F){return N.t-F.t}),M=0,y=0;y<O.length;y++)L=O[y],B={ease:L.e,duration:(L.t-(y?O[y-1].t:0))/100*c},B[S]=L.v,k.to(x,B,M),M+=B.duration;k.duration()<c&&k.to({},{duration:c-k.duration()})}}c||o.duration(c=k.duration())}else o.timeline=0;return g===!0&&!Sr&&(Pt=xt(o),$.killTweensOf(x),Pt=0),bt(v,xt(o),n),i.reversed&&o.reverse(),i.paused&&o.paused(!0),(d||!c&&!p&&o._start===G(v._time)&&rt(d)&&cs(xt(o))&&v.data!=="nested")&&(o._tTime=-D,o.render(Math.max(0,-h)||0)),_&&Ni(xt(o),_),o}var e=t.prototype;return e.render=function(i,n,s){var o=this._time,l=this._tDur,c=this._dur,h=i<0,d=i>l-D&&!h?l:i<D?0:i,f,g,p,u,_,b,v,x,k;if(!c)us(this,i,n,s);else if(d!==this._tTime||!i||s||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==h||this._lazy){if(f=d,x=this.timeline,this._repeat){if(u=c+this._rDelay,this._repeat<-1&&h)return this.totalTime(u*100+i,n,s);if(f=G(d%u),d===l?(p=this._repeat,f=c):(_=G(d/u),p=~~_,p&&p===_?(f=c,p--):f>c&&(f=c)),b=this._yoyo&&p&1,b&&(k=this._yEase,f=c-f),_=le(this._tTime,u),f===o&&!s&&this._initted&&p===_)return this._tTime=d,this;p!==_&&(x&&this._yEase&&Ji(x,b),this.vars.repeatRefresh&&!b&&!this._lock&&f!==u&&this._initted&&(this._lock=s=1,this.render(G(u*p),!0).invalidate()._lock=0))}if(!this._initted){if(Fi(this,h?i:f,s,n,d))return this._tTime=0,this;if(o!==this._time&&!(s&&this.vars.repeatRefresh&&p!==_))return this;if(c!==this._dur)return this.render(i,n,s)}if(this._tTime=d,this._time=f,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=v=(k||this._ease)(f/c),this._from&&(this.ratio=v=1-v),!o&&d&&!n&&!_&&(ct(this,"onStart"),this._tTime!==d))return this;for(g=this._pt;g;)g.r(v,g.d),g=g._next;x&&x.render(i<0?i:x._dur*x._ease(f/this._dur),n,s)||this._startAt&&(this._zTime=i),this._onUpdate&&!n&&(h&&dr(this,i,n,s),ct(this,"onUpdate")),this._repeat&&p!==_&&this.vars.onRepeat&&!n&&this.parent&&ct(this,"onRepeat"),(d===this._tDur||!d)&&this._tTime===d&&(h&&!this._onUpdate&&dr(this,i,!0,!0),(i||!c)&&(d===this._tDur&&this._ts>0||!d&&this._ts<0)&&Lt(this,1),!n&&!(h&&!o)&&(d||o||b)&&(ct(this,d===l?"onComplete":"onReverseComplete",!0),this._prom&&!(d<l&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(i){return(!i||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(i),a.prototype.invalidate.call(this,i)},e.resetTo=function(i,n,s,o,l){Ce||lt.wake(),this._ts||this.play();var c=Math.min(this._dur,(this._dp._time-this._start)*this._ts),h;return this._initted||Lr(this,c),h=this._ease(c/this._dur),Ps(this,i,n,s,o,h,c,l)?this.resetTo(i,n,s,o,1):(Ke(this,0),this.parent||Li(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},e.kill=function(i,n){if(n===void 0&&(n="all"),!i&&(!n||n==="all"))return this._lazy=this._pt=0,this.parent?ge(this):this.scrollTrigger&&this.scrollTrigger.kill(!!K),this;if(this.timeline){var s=this.timeline.totalDuration();return this.timeline.killTweensOf(i,n,Pt&&Pt.vars.overwrite!==!0)._first||ge(this),this.parent&&s!==this.timeline.totalDuration()&&ce(this,this._dur*this.timeline._tDur/s,0,1),this}var o=this._targets,l=i?pt(i):o,c=this._ptLookup,h=this._pt,d,f,g,p,u,_,b;if((!n||n==="all")&&as(o,l))return n==="all"&&(this._pt=0),ge(this);for(d=this._op=this._op||[],n!=="all"&&(X(n)&&(u={},it(n,function(v){return u[v]=1}),n=u),n=Ms(o,n)),b=o.length;b--;)if(~l.indexOf(o[b])){f=c[b],n==="all"?(d[b]=n,p=f,g={}):(g=d[b]=d[b]||{},p=n);for(u in p)_=f&&f[u],_&&((!("kill"in _.d)||_.d.kill(u)===!0)&&Ge(this,_,"_pt"),delete f[u]),g!=="all"&&(g[u]=1)}return this._initted&&!this._pt&&h&&ge(this),this},t.to=function(i,n){return new t(i,n,arguments[2])},t.from=function(i,n){return me(1,arguments)},t.delayedCall=function(i,n,s,o){return new t(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:i,onComplete:n,onReverseComplete:n,onCompleteParams:s,onReverseCompleteParams:s,callbackScope:o})},t.fromTo=function(i,n,s){return me(2,arguments)},t.set=function(i,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new t(i,n)},t.killTweensOf=function(i,n,s){return $.killTweensOf(i,n,s)},t}(Te);dt(Y.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});it("staggerTo,staggerFrom,staggerFromTo",function(a){Y[a]=function(){var t=new tt,e=gr.call(arguments,0);return e.splice(a==="staggerFromTo"?5:4,0,0),t[a].apply(t,e)}});var Br=function(t,e,r){return t[e]=r},sn=function(t,e,r){return t[e](r)},Ds=function(t,e,r,i){return t[e](i.fp,r)},Rs=function(t,e,r){return t.setAttribute(e,r)},Nr=function(t,e){return U(t[e])?sn:kr(t[e])&&t.setAttribute?Rs:Br},on=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e6)/1e6,e)},Ls=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},an=function(t,e){var r=e._pt,i="";if(!t&&e.b)i=e.b;else if(t===1&&e.e)i=e.e;else{for(;r;)i=r.p+(r.m?r.m(r.s+r.c*t):Math.round((r.s+r.c*t)*1e4)/1e4)+i,r=r._next;i+=e.c}e.set(e.t,e.p,i,e)},Fr=function(t,e){for(var r=e._pt;r;)r.r(t,r.d),r=r._next},Bs=function(t,e,r,i){for(var n=this._pt,s;n;)s=n._next,n.p===i&&n.modifier(t,e,r),n=s},Ns=function(t){for(var e=this._pt,r,i;e;)i=e._next,e.p===t&&!e.op||e.op===t?Ge(this,e,"_pt"):e.dep||(r=1),e=i;return!r},Fs=function(t,e,r,i){i.mSet(t,e,i.m.call(i.tween,r,i.mt),i)},ln=function(t){for(var e=t._pt,r,i,n,s;e;){for(r=e._next,i=n;i&&i.pr>e.pr;)i=i._next;(e._prev=i?i._prev:s)?e._prev._next=e:n=e,(e._next=i)?i._prev=e:s=e,e=r}t._pt=n},nt=function(){function a(e,r,i,n,s,o,l,c,h){this.t=r,this.s=n,this.c=s,this.p=i,this.r=o||on,this.d=l||this,this.set=c||Br,this.pr=h||0,this._next=e,e&&(e._prev=this)}var t=a.prototype;return t.modifier=function(r,i,n){this.mSet=this.mSet||this.set,this.set=Fs,this.m=r,this.mt=n,this.tween=i},a}();it(Mr+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(a){return Pr[a]=1});ut.TweenMax=ut.TweenLite=Y;ut.TimelineLite=ut.TimelineMax=tt;$=new tt({sortChildren:!1,defaults:oe,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});ht.stringFilter=ji;var Xt=[],Me={},zs=[],ti=0,Hs=0,er=function(t){return(Me[t]||zs).map(function(e){return e()})},yr=function(){var t=Date.now(),e=[];t-ti>2&&(er("matchMediaInit"),Xt.forEach(function(r){var i=r.queries,n=r.conditions,s,o,l,c;for(o in i)s=yt.matchMedia(i[o]).matches,s&&(l=1),s!==n[o]&&(n[o]=s,c=1);c&&(r.revert(),l&&e.push(r))}),er("matchMediaRevert"),e.forEach(function(r){return r.onMatch(r,function(i){return r.add(null,i)})}),ti=t,er("matchMedia"))},cn=function(){function a(e,r){this.selector=r&&pr(r),this.data=[],this._r=[],this.isReverted=!1,this.id=Hs++,e&&this.add(e)}var t=a.prototype;return t.add=function(r,i,n){U(r)&&(n=i,i=r,r=U);var s=this,o=function(){var c=H,h=s.selector,d;return c&&c!==s&&c.data.push(s),n&&(s.selector=pr(n)),H=s,d=i.apply(s,arguments),U(d)&&s._r.push(d),H=c,s.selector=h,s.isReverted=!1,d};return s.last=o,r===U?o(s,function(l){return s.add(null,l)}):r?s[r]=o:o},t.ignore=function(r){var i=H;H=null,r(this),H=i},t.getTweens=function(){var r=[];return this.data.forEach(function(i){return i instanceof a?r.push.apply(r,i.getTweens()):i instanceof Y&&!(i.parent&&i.parent.data==="nested")&&r.push(i)}),r},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(r,i){var n=this;if(r?function(){for(var o=n.getTweens(),l=n.data.length,c;l--;)c=n.data[l],c.data==="isFlip"&&(c.revert(),c.getChildren(!0,!0,!1).forEach(function(h){return o.splice(o.indexOf(h),1)}));for(o.map(function(h){return{g:h._dur||h._delay||h._sat&&!h._sat.vars.immediateRender?h.globalTime(0):-1/0,t:h}}).sort(function(h,d){return d.g-h.g||-1/0}).forEach(function(h){return h.t.revert(r)}),l=n.data.length;l--;)c=n.data[l],c instanceof tt?c.data!=="nested"&&(c.scrollTrigger&&c.scrollTrigger.revert(),c.kill()):!(c instanceof Y)&&c.revert&&c.revert(r);n._r.forEach(function(h){return h(r,n)}),n.isReverted=!0}():this.data.forEach(function(o){return o.kill&&o.kill()}),this.clear(),i)for(var s=Xt.length;s--;)Xt[s].id===this.id&&Xt.splice(s,1)},t.revert=function(r){this.kill(r||{})},a}(),$s=function(){function a(e){this.contexts=[],this.scope=e,H&&H.data.push(this)}var t=a.prototype;return t.add=function(r,i,n){wt(r)||(r={matches:r});var s=new cn(0,n||this.scope),o=s.conditions={},l,c,h;H&&!s.selector&&(s.selector=H.selector),this.contexts.push(s),i=s.add("onMatch",i),s.queries=r;for(c in r)c==="all"?h=1:(l=yt.matchMedia(r[c]),l&&(Xt.indexOf(s)<0&&Xt.push(s),(o[c]=l.matches)&&(h=1),l.addListener?l.addListener(yr):l.addEventListener("change",yr)));return h&&i(s,function(d){return s.add(null,d)}),this},t.revert=function(r){this.kill(r||{})},t.kill=function(r){this.contexts.forEach(function(i){return i.kill(r,!0)})},a}(),Ue={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];e.forEach(function(i){return Gi(i)})},timeline:function(t){return new tt(t)},getTweensOf:function(t,e){return $.getTweensOf(t,e)},getProperty:function(t,e,r,i){X(t)&&(t=pt(t)[0]);var n=Wt(t||{}).get,s=r?Ri:Di;return r==="native"&&(r=""),t&&(e?s((at[e]&&at[e].get||n)(t,e,r,i)):function(o,l,c){return s((at[o]&&at[o].get||n)(t,o,l,c))})},quickSetter:function(t,e,r){if(t=pt(t),t.length>1){var i=t.map(function(h){return ot.quickSetter(h,e,r)}),n=i.length;return function(h){for(var d=n;d--;)i[d](h)}}t=t[0]||{};var s=at[e],o=Wt(t),l=o.harness&&(o.harness.aliases||{})[e]||e,c=s?function(h){var d=new s;ee._pt=0,d.init(t,r?h+r:h,ee,0,[t]),d.render(1,d),ee._pt&&Fr(1,ee)}:o.set(t,l);return s?c:function(h){return c(t,l,r?h+r:h,o,1)}},quickTo:function(t,e,r){var i,n=ot.to(t,dt((i={},i[e]="+=0.1",i.paused=!0,i.stagger=0,i),r||{})),s=function(l,c,h){return n.resetTo(e,l,c,h)};return s.tween=n,s},isTweening:function(t){return $.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Gt(t.ease,oe.ease)),Kr(oe,t||{})},config:function(t){return Kr(ht,t||{})},registerEffect:function(t){var e=t.name,r=t.effect,i=t.plugins,n=t.defaults,s=t.extendTimeline;(i||"").split(",").forEach(function(o){return o&&!at[o]&&!ut[o]&&be(e+" effect requires "+o+" plugin.")}),Qe[e]=function(o,l,c){return r(pt(o),dt(l||{},n),c)},s&&(tt.prototype[e]=function(o,l,c){return this.add(Qe[e](o,wt(l)?l:(c=l)&&{},this),c)})},registerEase:function(t,e){P[t]=Gt(e)},parseEase:function(t,e){return arguments.length?Gt(t,e):P},getById:function(t){return $.getById(t)},exportRoot:function(t,e){t===void 0&&(t={});var r=new tt(t),i,n;for(r.smoothChildTiming=rt(t.smoothChildTiming),$.remove(r),r._dp=0,r._time=r._tTime=$._time,i=$._first;i;)n=i._next,(e||!(!i._dur&&i instanceof Y&&i.vars.onComplete===i._targets[0]))&&bt(r,i,i._start-i._delay),i=n;return bt($,r,0),r},context:function(t,e){return t?new cn(t,e):H},matchMedia:function(t){return new $s(t)},matchMediaRefresh:function(){return Xt.forEach(function(t){var e=t.conditions,r,i;for(i in e)e[i]&&(e[i]=!1,r=1);r&&t.revert()})||yr()},addEventListener:function(t,e){var r=Me[t]||(Me[t]=[]);~r.indexOf(e)||r.push(e)},removeEventListener:function(t,e){var r=Me[t],i=r&&r.indexOf(e);i>=0&&r.splice(i,1)},utils:{wrap:bs,wrapYoyo:vs,distribute:$i,random:Ui,snap:qi,normalize:ys,getUnit:J,clamp:gs,splitColor:Xi,toArray:pt,selector:pr,mapRange:Wi,pipe:_s,unitize:ms,interpolate:ws,shuffle:Hi},install:Oi,effects:Qe,ticker:lt,updateRoot:tt.updateRoot,plugins:at,globalTimeline:$,core:{PropTween:nt,globals:Ai,Tween:Y,Timeline:tt,Animation:Te,getCache:Wt,_removeLinkedListItem:Ge,reverting:function(){return K},context:function(t){return t&&H&&(H.data.push(t),t._ctx=H),H},suppressOverwrites:function(t){return Sr=t}}};it("to,from,fromTo,delayedCall,set,killTweensOf",function(a){return Ue[a]=Y[a]});lt.add(tt.updateRoot);ee=Ue.to({},{duration:0});var qs=function(t,e){for(var r=t._pt;r&&r.p!==e&&r.op!==e&&r.fp!==e;)r=r._next;return r},Us=function(t,e){var r=t._targets,i,n,s;for(i in e)for(n=r.length;n--;)s=t._ptLookup[n][i],s&&(s=s.d)&&(s._pt&&(s=qs(s,i)),s&&s.modifier&&s.modifier(e[i],t,r[n],i))},rr=function(t,e){return{name:t,headless:1,rawVars:1,init:function(i,n,s){s._onInit=function(o){var l,c;if(X(n)&&(l={},it(n,function(h){return l[h]=1}),n=l),e){l={};for(c in n)l[c]=e(n[c]);n=l}Us(o,n)}}}},ot=Ue.registerPlugin({name:"attr",init:function(t,e,r,i,n){var s,o,l;this.tween=r;for(s in e)l=t.getAttribute(s)||"",o=this.add(t,"setAttribute",(l||0)+"",e[s],i,n,0,0,s),o.op=s,o.b=l,this._props.push(s)},render:function(t,e){for(var r=e._pt;r;)K?r.set(r.t,r.p,r.b,r):r.r(t,r.d),r=r._next}},{name:"endArray",headless:1,init:function(t,e){for(var r=e.length;r--;)this.add(t,r,t[r]||0,e[r],0,0,0,0,0,1)}},rr("roundProps",_r),rr("modifiers"),rr("snap",qi))||Ue;Y.version=tt.version=ot.version="3.13.0";Ei=1;Er()&&he();P.Power0;P.Power1;P.Power2;P.Power3;P.Power4;P.Linear;P.Quad;P.Cubic;P.Quart;P.Quint;P.Strong;P.Elastic;P.Back;P.SteppedEase;P.Bounce;P.Sine;P.Expo;P.Circ;/*!
 * CSSPlugin 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var ei,Mt,ie,zr,Ut,ri,Hr,Vs=function(){return typeof window<"u"},Et={},qt=180/Math.PI,ne=Math.PI/180,Jt=Math.atan2,ii=1e8,$r=/([A-Z])/g,Ws=/(left|right|width|margin|padding|x)/i,Ys=/[\s,\(]\S/,vt={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},br=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},Gs=function(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},Xs=function(t,e){return e.set(e.t,e.p,t?Math.round((e.s+e.c*t)*1e4)/1e4+e.u:e.b,e)},Ks=function(t,e){var r=e.s+e.c*t;e.set(e.t,e.p,~~(r+(r<0?-.5:.5))+e.u,e)},hn=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},un=function(t,e){return e.set(e.t,e.p,t!==1?e.b:e.e,e)},js=function(t,e,r){return t.style[e]=r},Qs=function(t,e,r){return t.style.setProperty(e,r)},Js=function(t,e,r){return t._gsap[e]=r},Zs=function(t,e,r){return t._gsap.scaleX=t._gsap.scaleY=r},to=function(t,e,r,i,n){var s=t._gsap;s.scaleX=s.scaleY=r,s.renderTransform(n,s)},eo=function(t,e,r,i,n){var s=t._gsap;s[e]=r,s.renderTransform(n,s)},q="transform",st=q+"Origin",ro=function a(t,e){var r=this,i=this.target,n=i.style,s=i._gsap;if(t in Et&&n){if(this.tfm=this.tfm||{},t!=="transform")t=vt[t]||t,~t.indexOf(",")?t.split(",").forEach(function(o){return r.tfm[o]=St(i,o)}):this.tfm[t]=s.x?s[t]:St(i,t),t===st&&(this.tfm.zOrigin=s.zOrigin);else return vt.transform.split(",").forEach(function(o){return a.call(r,o,e)});if(this.props.indexOf(q)>=0)return;s.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(st,e,"")),t=q}(n||e)&&this.props.push(t,e,n[t])},dn=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},io=function(){var t=this.props,e=this.target,r=e.style,i=e._gsap,n,s;for(n=0;n<t.length;n+=3)t[n+1]?t[n+1]===2?e[t[n]](t[n+2]):e[t[n]]=t[n+2]:t[n+2]?r[t[n]]=t[n+2]:r.removeProperty(t[n].substr(0,2)==="--"?t[n]:t[n].replace($r,"-$1").toLowerCase());if(this.tfm){for(s in this.tfm)i[s]=this.tfm[s];i.svg&&(i.renderTransform(),e.setAttribute("data-svg-origin",this.svgo||"")),n=Hr(),(!n||!n.isStart)&&!r[q]&&(dn(r),i.zOrigin&&r[st]&&(r[st]+=" "+i.zOrigin+"px",i.zOrigin=0,i.renderTransform()),i.uncache=1)}},fn=function(t,e){var r={target:t,props:[],revert:io,save:ro};return t._gsap||ot.core.getCache(t),e&&t.style&&t.nodeType&&e.split(",").forEach(function(i){return r.save(i)}),r},gn,vr=function(t,e){var r=Mt.createElementNS?Mt.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Mt.createElement(t);return r&&r.style?r:Mt.createElement(t)},_t=function a(t,e,r){var i=getComputedStyle(t);return i[e]||i.getPropertyValue(e.replace($r,"-$1").toLowerCase())||i.getPropertyValue(e)||!r&&a(t,ue(e)||e,1)||""},ni="O,Moz,ms,Ms,Webkit".split(","),ue=function(t,e,r){var i=e||Ut,n=i.style,s=5;if(t in n&&!r)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);s--&&!(ni[s]+t in n););return s<0?null:(s===3?"ms":s>=0?ni[s]:"")+t},wr=function(){Vs()&&window.document&&(ei=window,Mt=ei.document,ie=Mt.documentElement,Ut=vr("div")||{style:{}},vr("div"),q=ue(q),st=q+"Origin",Ut.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",gn=!!ue("perspective"),Hr=ot.core.reverting,zr=1)},si=function(t){var e=t.ownerSVGElement,r=vr("svg",e&&e.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=t.cloneNode(!0),n;i.style.display="block",r.appendChild(i),ie.appendChild(r);try{n=i.getBBox()}catch{}return r.removeChild(i),ie.removeChild(r),n},oi=function(t,e){for(var r=e.length;r--;)if(t.hasAttribute(e[r]))return t.getAttribute(e[r])},pn=function(t){var e,r;try{e=t.getBBox()}catch{e=si(t),r=1}return e&&(e.width||e.height)||r||(e=si(t)),e&&!e.width&&!e.x&&!e.y?{x:+oi(t,["x","cx","x1"])||0,y:+oi(t,["y","cy","y1"])||0,width:0,height:0}:e},_n=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&pn(t))},Kt=function(t,e){if(e){var r=t.style,i;e in Et&&e!==st&&(e=q),r.removeProperty?(i=e.substr(0,2),(i==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),r.removeProperty(i==="--"?e:e.replace($r,"-$1").toLowerCase())):r.removeAttribute(e)}},It=function(t,e,r,i,n,s){var o=new nt(t._pt,e,r,0,1,s?un:hn);return t._pt=o,o.b=i,o.e=n,t._props.push(r),o},ai={deg:1,rad:1,turn:1},no={grid:1,flex:1},Bt=function a(t,e,r,i){var n=parseFloat(r)||0,s=(r+"").trim().substr((n+"").length)||"px",o=Ut.style,l=Ws.test(e),c=t.tagName.toLowerCase()==="svg",h=(c?"client":"offset")+(l?"Width":"Height"),d=100,f=i==="px",g=i==="%",p,u,_,b;if(i===s||!n||ai[i]||ai[s])return n;if(s!=="px"&&!f&&(n=a(t,e,r,"px")),b=t.getCTM&&_n(t),(g||s==="%")&&(Et[e]||~e.indexOf("adius")))return p=b?t.getBBox()[l?"width":"height"]:t[h],W(g?n/p*d:n/100*p);if(o[l?"width":"height"]=d+(f?s:i),u=i!=="rem"&&~e.indexOf("adius")||i==="em"&&t.appendChild&&!c?t:t.parentNode,b&&(u=(t.ownerSVGElement||{}).parentNode),(!u||u===Mt||!u.appendChild)&&(u=Mt.body),_=u._gsap,_&&g&&_.width&&l&&_.time===lt.time&&!_.uncache)return W(n/_.width*d);if(g&&(e==="height"||e==="width")){var v=t.style[e];t.style[e]=d+i,p=t[h],v?t.style[e]=v:Kt(t,e)}else(g||s==="%")&&!no[_t(u,"display")]&&(o.position=_t(t,"position")),u===t&&(o.position="static"),u.appendChild(Ut),p=Ut[h],u.removeChild(Ut),o.position="absolute";return l&&g&&(_=Wt(u),_.time=lt.time,_.width=u[h]),W(f?p*n/d:p&&n?d/p*n:0)},St=function(t,e,r,i){var n;return zr||wr(),e in vt&&e!=="transform"&&(e=vt[e],~e.indexOf(",")&&(e=e.split(",")[0])),Et[e]&&e!=="transform"?(n=Se(t,i),n=e!=="transformOrigin"?n[e]:n.svg?n.origin:We(_t(t,st))+" "+n.zOrigin+"px"):(n=t.style[e],(!n||n==="auto"||i||~(n+"").indexOf("calc("))&&(n=Ve[e]&&Ve[e](t,e,r)||_t(t,e)||Mi(t,e)||(e==="opacity"?1:0))),r&&!~(n+"").trim().indexOf(" ")?Bt(t,e,n,r)+r:n},so=function(t,e,r,i){if(!r||r==="none"){var n=ue(e,t,1),s=n&&_t(t,n,1);s&&s!==r?(e=n,r=s):e==="borderColor"&&(r=_t(t,"borderTopColor"))}var o=new nt(this._pt,t.style,e,0,1,an),l=0,c=0,h,d,f,g,p,u,_,b,v,x,k,y;if(o.b=r,o.e=i,r+="",i+="",i.substring(0,6)==="var(--"&&(i=_t(t,i.substring(4,i.indexOf(")")))),i==="auto"&&(u=t.style[e],t.style[e]=i,i=_t(t,e)||i,u?t.style[e]=u:Kt(t,e)),h=[r,i],ji(h),r=h[0],i=h[1],f=r.match(te)||[],y=i.match(te)||[],y.length){for(;d=te.exec(i);)_=d[0],v=i.substring(l,d.index),p?p=(p+1)%5:(v.substr(-5)==="rgba("||v.substr(-5)==="hsla(")&&(p=1),_!==(u=f[c++]||"")&&(g=parseFloat(u)||0,k=u.substr((g+"").length),_.charAt(1)==="="&&(_=re(g,_)+k),b=parseFloat(_),x=_.substr((b+"").length),l=te.lastIndex-x.length,x||(x=x||ht.units[e]||k,l===i.length&&(i+=x,o.e+=x)),k!==x&&(g=Bt(t,e,u,x)||0),o._pt={_next:o._pt,p:v||c===1?v:",",s:g,c:b-g,m:p&&p<4||e==="zIndex"?Math.round:0});o.c=l<i.length?i.substring(l,i.length):""}else o.r=e==="display"&&i==="none"?un:hn;return Si.test(i)&&(o.e=0),this._pt=o,o},li={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},oo=function(t){var e=t.split(" "),r=e[0],i=e[1]||"50%";return(r==="top"||r==="bottom"||i==="left"||i==="right")&&(t=r,r=i,i=t),e[0]=li[r]||r,e[1]=li[i]||i,e.join(" ")},ao=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var r=e.t,i=r.style,n=e.u,s=r._gsap,o,l,c;if(n==="all"||n===!0)i.cssText="",l=1;else for(n=n.split(","),c=n.length;--c>-1;)o=n[c],Et[o]&&(l=1,o=o==="transformOrigin"?st:q),Kt(r,o);l&&(Kt(r,q),s&&(s.svg&&r.removeAttribute("transform"),i.scale=i.rotate=i.translate="none",Se(r,1),s.uncache=1,dn(i)))}},Ve={clearProps:function(t,e,r,i,n){if(n.data!=="isFromStart"){var s=t._pt=new nt(t._pt,e,r,0,0,ao);return s.u=i,s.pr=-10,s.tween=n,t._props.push(r),1}}},xe=[1,0,0,1,0,0],mn={},yn=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},ci=function(t){var e=_t(t,q);return yn(e)?xe:e.substr(7).match(xi).map(W)},qr=function(t,e){var r=t._gsap||Wt(t),i=t.style,n=ci(t),s,o,l,c;return r.svg&&t.getAttribute("transform")?(l=t.transform.baseVal.consolidate().matrix,n=[l.a,l.b,l.c,l.d,l.e,l.f],n.join(",")==="1,0,0,1,0,0"?xe:n):(n===xe&&!t.offsetParent&&t!==ie&&!r.svg&&(l=i.display,i.display="block",s=t.parentNode,(!s||!t.offsetParent&&!t.getBoundingClientRect().width)&&(c=1,o=t.nextElementSibling,ie.appendChild(t)),n=ci(t),l?i.display=l:Kt(t,"display"),c&&(o?s.insertBefore(t,o):s?s.appendChild(t):ie.removeChild(t))),e&&n.length>6?[n[0],n[1],n[4],n[5],n[12],n[13]]:n)},Cr=function(t,e,r,i,n,s){var o=t._gsap,l=n||qr(t,!0),c=o.xOrigin||0,h=o.yOrigin||0,d=o.xOffset||0,f=o.yOffset||0,g=l[0],p=l[1],u=l[2],_=l[3],b=l[4],v=l[5],x=e.split(" "),k=parseFloat(x[0])||0,y=parseFloat(x[1])||0,C,T,S,w;r?l!==xe&&(T=g*_-p*u)&&(S=k*(_/T)+y*(-u/T)+(u*v-_*b)/T,w=k*(-p/T)+y*(g/T)-(g*v-p*b)/T,k=S,y=w):(C=pn(t),k=C.x+(~x[0].indexOf("%")?k/100*C.width:k),y=C.y+(~(x[1]||x[0]).indexOf("%")?y/100*C.height:y)),i||i!==!1&&o.smooth?(b=k-c,v=y-h,o.xOffset=d+(b*g+v*u)-b,o.yOffset=f+(b*p+v*_)-v):o.xOffset=o.yOffset=0,o.xOrigin=k,o.yOrigin=y,o.smooth=!!i,o.origin=e,o.originIsAbsolute=!!r,t.style[st]="0px 0px",s&&(It(s,o,"xOrigin",c,k),It(s,o,"yOrigin",h,y),It(s,o,"xOffset",d,o.xOffset),It(s,o,"yOffset",f,o.yOffset)),t.setAttribute("data-svg-origin",k+" "+y)},Se=function(t,e){var r=t._gsap||new tn(t);if("x"in r&&!e&&!r.uncache)return r;var i=t.style,n=r.scaleX<0,s="px",o="deg",l=getComputedStyle(t),c=_t(t,st)||"0",h,d,f,g,p,u,_,b,v,x,k,y,C,T,S,w,A,R,M,O,L,B,N,F,et,Ft,Ot,At,Ct,Ee,mt,zt;return h=d=f=u=_=b=v=x=k=0,g=p=1,r.svg=!!(t.getCTM&&_n(t)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(i[q]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[q]!=="none"?l[q]:"")),i.scale=i.rotate=i.translate="none"),T=qr(t,r.svg),r.svg&&(r.uncache?(et=t.getBBox(),c=r.xOrigin-et.x+"px "+(r.yOrigin-et.y)+"px",F=""):F=!e&&t.getAttribute("data-svg-origin"),Cr(t,F||c,!!F||r.originIsAbsolute,r.smooth!==!1,T)),y=r.xOrigin||0,C=r.yOrigin||0,T!==xe&&(R=T[0],M=T[1],O=T[2],L=T[3],h=B=T[4],d=N=T[5],T.length===6?(g=Math.sqrt(R*R+M*M),p=Math.sqrt(L*L+O*O),u=R||M?Jt(M,R)*qt:0,v=O||L?Jt(O,L)*qt+u:0,v&&(p*=Math.abs(Math.cos(v*ne))),r.svg&&(h-=y-(y*R+C*O),d-=C-(y*M+C*L))):(zt=T[6],Ee=T[7],Ot=T[8],At=T[9],Ct=T[10],mt=T[11],h=T[12],d=T[13],f=T[14],S=Jt(zt,Ct),_=S*qt,S&&(w=Math.cos(-S),A=Math.sin(-S),F=B*w+Ot*A,et=N*w+At*A,Ft=zt*w+Ct*A,Ot=B*-A+Ot*w,At=N*-A+At*w,Ct=zt*-A+Ct*w,mt=Ee*-A+mt*w,B=F,N=et,zt=Ft),S=Jt(-O,Ct),b=S*qt,S&&(w=Math.cos(-S),A=Math.sin(-S),F=R*w-Ot*A,et=M*w-At*A,Ft=O*w-Ct*A,mt=L*A+mt*w,R=F,M=et,O=Ft),S=Jt(M,R),u=S*qt,S&&(w=Math.cos(S),A=Math.sin(S),F=R*w+M*A,et=B*w+N*A,M=M*w-R*A,N=N*w-B*A,R=F,B=et),_&&Math.abs(_)+Math.abs(u)>359.9&&(_=u=0,b=180-b),g=W(Math.sqrt(R*R+M*M+O*O)),p=W(Math.sqrt(N*N+zt*zt)),S=Jt(B,N),v=Math.abs(S)>2e-4?S*qt:0,k=mt?1/(mt<0?-mt:mt):0),r.svg&&(F=t.getAttribute("transform"),r.forceCSS=t.setAttribute("transform","")||!yn(_t(t,q)),F&&t.setAttribute("transform",F))),Math.abs(v)>90&&Math.abs(v)<270&&(n?(g*=-1,v+=u<=0?180:-180,u+=u<=0?180:-180):(p*=-1,v+=v<=0?180:-180)),e=e||r.uncache,r.x=h-((r.xPercent=h&&(!e&&r.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-h)?-50:0)))?t.offsetWidth*r.xPercent/100:0)+s,r.y=d-((r.yPercent=d&&(!e&&r.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-d)?-50:0)))?t.offsetHeight*r.yPercent/100:0)+s,r.z=f+s,r.scaleX=W(g),r.scaleY=W(p),r.rotation=W(u)+o,r.rotationX=W(_)+o,r.rotationY=W(b)+o,r.skewX=v+o,r.skewY=x+o,r.transformPerspective=k+s,(r.zOrigin=parseFloat(c.split(" ")[2])||!e&&r.zOrigin||0)&&(i[st]=We(c)),r.xOffset=r.yOffset=0,r.force3D=ht.force3D,r.renderTransform=r.svg?co:gn?bn:lo,r.uncache=0,r},We=function(t){return(t=t.split(" "))[0]+" "+t[1]},ir=function(t,e,r){var i=J(e);return W(parseFloat(e)+parseFloat(Bt(t,"x",r+"px",i)))+i},lo=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,bn(t,e)},Ht="0deg",de="0px",$t=") ",bn=function(t,e){var r=e||this,i=r.xPercent,n=r.yPercent,s=r.x,o=r.y,l=r.z,c=r.rotation,h=r.rotationY,d=r.rotationX,f=r.skewX,g=r.skewY,p=r.scaleX,u=r.scaleY,_=r.transformPerspective,b=r.force3D,v=r.target,x=r.zOrigin,k="",y=b==="auto"&&t&&t!==1||b===!0;if(x&&(d!==Ht||h!==Ht)){var C=parseFloat(h)*ne,T=Math.sin(C),S=Math.cos(C),w;C=parseFloat(d)*ne,w=Math.cos(C),s=ir(v,s,T*w*-x),o=ir(v,o,-Math.sin(C)*-x),l=ir(v,l,S*w*-x+x)}_!==de&&(k+="perspective("+_+$t),(i||n)&&(k+="translate("+i+"%, "+n+"%) "),(y||s!==de||o!==de||l!==de)&&(k+=l!==de||y?"translate3d("+s+", "+o+", "+l+") ":"translate("+s+", "+o+$t),c!==Ht&&(k+="rotate("+c+$t),h!==Ht&&(k+="rotateY("+h+$t),d!==Ht&&(k+="rotateX("+d+$t),(f!==Ht||g!==Ht)&&(k+="skew("+f+", "+g+$t),(p!==1||u!==1)&&(k+="scale("+p+", "+u+$t),v.style[q]=k||"translate(0, 0)"},co=function(t,e){var r=e||this,i=r.xPercent,n=r.yPercent,s=r.x,o=r.y,l=r.rotation,c=r.skewX,h=r.skewY,d=r.scaleX,f=r.scaleY,g=r.target,p=r.xOrigin,u=r.yOrigin,_=r.xOffset,b=r.yOffset,v=r.forceCSS,x=parseFloat(s),k=parseFloat(o),y,C,T,S,w;l=parseFloat(l),c=parseFloat(c),h=parseFloat(h),h&&(h=parseFloat(h),c+=h,l+=h),l||c?(l*=ne,c*=ne,y=Math.cos(l)*d,C=Math.sin(l)*d,T=Math.sin(l-c)*-f,S=Math.cos(l-c)*f,c&&(h*=ne,w=Math.tan(c-h),w=Math.sqrt(1+w*w),T*=w,S*=w,h&&(w=Math.tan(h),w=Math.sqrt(1+w*w),y*=w,C*=w)),y=W(y),C=W(C),T=W(T),S=W(S)):(y=d,S=f,C=T=0),(x&&!~(s+"").indexOf("px")||k&&!~(o+"").indexOf("px"))&&(x=Bt(g,"x",s,"px"),k=Bt(g,"y",o,"px")),(p||u||_||b)&&(x=W(x+p-(p*y+u*T)+_),k=W(k+u-(p*C+u*S)+b)),(i||n)&&(w=g.getBBox(),x=W(x+i/100*w.width),k=W(k+n/100*w.height)),w="matrix("+y+","+C+","+T+","+S+","+x+","+k+")",g.setAttribute("transform",w),v&&(g.style[q]=w)},ho=function(t,e,r,i,n){var s=360,o=X(n),l=parseFloat(n)*(o&&~n.indexOf("rad")?qt:1),c=l-i,h=i+c+"deg",d,f;return o&&(d=n.split("_")[1],d==="short"&&(c%=s,c!==c%(s/2)&&(c+=c<0?s:-s)),d==="cw"&&c<0?c=(c+s*ii)%s-~~(c/s)*s:d==="ccw"&&c>0&&(c=(c-s*ii)%s-~~(c/s)*s)),t._pt=f=new nt(t._pt,e,r,i,c,Gs),f.e=h,f.u="deg",t._props.push(r),f},hi=function(t,e){for(var r in e)t[r]=e[r];return t},uo=function(t,e,r){var i=hi({},r._gsap),n="perspective,force3D,transformOrigin,svgOrigin",s=r.style,o,l,c,h,d,f,g,p;i.svg?(c=r.getAttribute("transform"),r.setAttribute("transform",""),s[q]=e,o=Se(r,1),Kt(r,q),r.setAttribute("transform",c)):(c=getComputedStyle(r)[q],s[q]=e,o=Se(r,1),s[q]=c);for(l in Et)c=i[l],h=o[l],c!==h&&n.indexOf(l)<0&&(g=J(c),p=J(h),d=g!==p?Bt(r,l,c,p):parseFloat(c),f=parseFloat(h),t._pt=new nt(t._pt,o,l,d,f-d,br),t._pt.u=p||0,t._props.push(l));hi(o,i)};it("padding,margin,Width,Radius",function(a,t){var e="Top",r="Right",i="Bottom",n="Left",s=(t<3?[e,r,i,n]:[e+n,e+r,i+r,i+n]).map(function(o){return t<2?a+o:"border"+o+a});Ve[t>1?"border"+a:a]=function(o,l,c,h,d){var f,g;if(arguments.length<4)return f=s.map(function(p){return St(o,p,c)}),g=f.join(" "),g.split(f[0]).length===5?f[0]:g;f=(h+"").split(" "),g={},s.forEach(function(p,u){return g[p]=f[u]=f[u]||f[(u-1)/2|0]}),o.init(l,g,d)}});var vn={name:"css",register:wr,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,r,i,n){var s=this._props,o=t.style,l=r.vars.startAt,c,h,d,f,g,p,u,_,b,v,x,k,y,C,T,S;zr||wr(),this.styles=this.styles||fn(t),S=this.styles.props,this.tween=r;for(u in e)if(u!=="autoRound"&&(h=e[u],!(at[u]&&en(u,e,r,i,t,n)))){if(g=typeof h,p=Ve[u],g==="function"&&(h=h.call(r,i,t,n),g=typeof h),g==="string"&&~h.indexOf("random(")&&(h=we(h)),p)p(this,t,u,h,r)&&(T=1);else if(u.substr(0,2)==="--")c=(getComputedStyle(t).getPropertyValue(u)+"").trim(),h+="",Rt.lastIndex=0,Rt.test(c)||(_=J(c),b=J(h)),b?_!==b&&(c=Bt(t,u,c,b)+b):_&&(h+=_),this.add(o,"setProperty",c,h,i,n,0,0,u),s.push(u),S.push(u,0,o[u]);else if(g!=="undefined"){if(l&&u in l?(c=typeof l[u]=="function"?l[u].call(r,i,t,n):l[u],X(c)&&~c.indexOf("random(")&&(c=we(c)),J(c+"")||c==="auto"||(c+=ht.units[u]||J(St(t,u))||""),(c+"").charAt(1)==="="&&(c=St(t,u))):c=St(t,u),f=parseFloat(c),v=g==="string"&&h.charAt(1)==="="&&h.substr(0,2),v&&(h=h.substr(2)),d=parseFloat(h),u in vt&&(u==="autoAlpha"&&(f===1&&St(t,"visibility")==="hidden"&&d&&(f=0),S.push("visibility",0,o.visibility),It(this,o,"visibility",f?"inherit":"hidden",d?"inherit":"hidden",!d)),u!=="scale"&&u!=="transform"&&(u=vt[u],~u.indexOf(",")&&(u=u.split(",")[0]))),x=u in Et,x){if(this.styles.save(u),g==="string"&&h.substring(0,6)==="var(--"&&(h=_t(t,h.substring(4,h.indexOf(")"))),d=parseFloat(h)),k||(y=t._gsap,y.renderTransform&&!e.parseTransform||Se(t,e.parseTransform),C=e.smoothOrigin!==!1&&y.smooth,k=this._pt=new nt(this._pt,o,q,0,1,y.renderTransform,y,0,-1),k.dep=1),u==="scale")this._pt=new nt(this._pt,y,"scaleY",y.scaleY,(v?re(y.scaleY,v+d):d)-y.scaleY||0,br),this._pt.u=0,s.push("scaleY",u),u+="X";else if(u==="transformOrigin"){S.push(st,0,o[st]),h=oo(h),y.svg?Cr(t,h,0,C,0,this):(b=parseFloat(h.split(" ")[2])||0,b!==y.zOrigin&&It(this,y,"zOrigin",y.zOrigin,b),It(this,o,u,We(c),We(h)));continue}else if(u==="svgOrigin"){Cr(t,h,1,C,0,this);continue}else if(u in mn){ho(this,y,u,f,v?re(f,v+h):h);continue}else if(u==="smoothOrigin"){It(this,y,"smooth",y.smooth,h);continue}else if(u==="force3D"){y[u]=h;continue}else if(u==="transform"){uo(this,h,t);continue}}else u in o||(u=ue(u)||u);if(x||(d||d===0)&&(f||f===0)&&!Ys.test(h)&&u in o)_=(c+"").substr((f+"").length),d||(d=0),b=J(h)||(u in ht.units?ht.units[u]:_),_!==b&&(f=Bt(t,u,c,b)),this._pt=new nt(this._pt,x?y:o,u,f,(v?re(f,v+d):d)-f,!x&&(b==="px"||u==="zIndex")&&e.autoRound!==!1?Ks:br),this._pt.u=b||0,_!==b&&b!=="%"&&(this._pt.b=c,this._pt.r=Xs);else if(u in o)so.call(this,t,u,c,v?v+h:h);else if(u in t)this.add(t,u,c||t[u],v?v+h:h,i,n);else if(u!=="parseTransform"){Ar(u,h);continue}x||(u in o?S.push(u,0,o[u]):typeof t[u]=="function"?S.push(u,2,t[u]()):S.push(u,1,c||t[u])),s.push(u)}}T&&ln(this)},render:function(t,e){if(e.tween._time||!Hr())for(var r=e._pt;r;)r.r(t,r.d),r=r._next;else e.styles.revert()},get:St,aliases:vt,getSetter:function(t,e,r){var i=vt[e];return i&&i.indexOf(",")<0&&(e=i),e in Et&&e!==st&&(t._gsap.x||St(t,"x"))?r&&ri===r?e==="scale"?Zs:Js:(ri=r||{})&&(e==="scale"?to:eo):t.style&&!kr(t.style[e])?js:~e.indexOf("-")?Qs:Nr(t,e)},core:{_removeProperty:Kt,_getMatrix:qr}};ot.utils.checkPrefix=ue;ot.core.getStyleSaver=fn;(function(a,t,e,r){var i=it(a+","+t+","+e,function(n){Et[n]=1});it(t,function(n){ht.units[n]="deg",mn[n]=1}),vt[i[13]]=a+","+t,it(r,function(n){var s=n.split(":");vt[s[1]]=i[s[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");it("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(a){ht.units[a]="px"});ot.registerPlugin(vn);var jt=ot.registerPlugin(vn)||ot;jt.core.Tween;function fo(a){return new Promise((t,e)=>{console.log("Speech function called with text:",a),window.speechSynthesis.cancel();const r=document.createElement("div");r.innerHTML=a;const i=r.textContent||r.innerText||"";console.log("Clean text for speech:",i);const n=new SpeechSynthesisUtterance(i);n.onend=()=>{console.log("Speech utterance ended"),t()},n.onerror=s=>{console.error("Speech utterance error:",s),e(s)},console.log("Starting speech after 50ms delay"),setTimeout(()=>{window.speechSynthesis.speak(n),console.log("Speech synthesis.speak() called")},50)})}function go(a){const t=document.querySelector(a);if(!t)return;const e=t.getBoundingClientRect(),r=10,i=(e.top-r)/window.innerHeight*100,n=(e.left-r)/window.innerWidth*100,s=(e.right+r)/window.innerWidth*100,o=(e.bottom+r)/window.innerHeight*100,l=`polygon(0% 0%, 0% 100%, ${n}% 100%, ${n}% ${i}%, ${s}% ${i}%, ${s}% ${o}%, ${n}% ${o}%, ${n}% 100%, 100% 100%, 100% 0%, 0% 0%)`;jt.to("#tutorial-mask",{clipPath:l,duration:.4,ease:"power2.inOut"})}function po(){jt.to("#tutorial-mask",{clipPath:"polygon(0% 0%, 0% 100%, 50% 100%, 50% 50%, 50% 50%, 50% 50%, 50% 50%, 50% 100%, 100% 100%, 100% 0%, 0% 0%)",duration:.4,ease:"power2.inOut"})}function _o(a){const t=document.querySelector(a);t&&jt.to(t,{position:"relative",zIndex:2001,boxShadow:"0 0 20px 8px #33c6dc",duration:.4})}function mo(a){const t=document.querySelector(a);t&&jt.to(t,{boxShadow:"0 0 0px 0px rgba(51,198,220,0)",duration:.3,onComplete:()=>jt.set(t,{clearProps:"all"})})}function nr(a){return new Promise(t=>{const e=m.rings[a];let r=!1;const i=()=>{if(!r)m.rings[a]!==e&&(r=!0);else if(!m.drag.active&&!m.animation){cancelAnimationFrame(n),t();return}n=requestAnimationFrame(i)};let n=requestAnimationFrame(i)})}function yo(){console.log("=== TUTORIAL START ==="),j.toggleSidebar(!1);const a=document.getElementById("tutorial-bubble"),t=document.getElementById("tutorial-mask"),e=document.getElementById("tutorial-text");if(console.log("Tutorial elements check:",{tutorialBubble:!!a,tutorialMask:!!t,tutorialText:!!e,bubbleStyles:a?{opacity:a.style.opacity,visibility:a.style.visibility,display:getComputedStyle(a).display}:null,textStyles:e?{opacity:e.style.opacity,visibility:e.style.visibility,display:getComputedStyle(e).display,innerHTML:e.innerHTML}:null}),a&&t&&e)console.log("All tutorial elements found successfully");else{console.error("Tutorial elements missing!",{tutorialBubble:!!a,tutorialMask:!!t,tutorialText:!!e});return}window.diatonicCompassTutorial&&(console.log("Killing existing tutorial timeline"),window.diatonicCompassTutorial.kill()),console.log("Creating new GSAP timeline");const r=jt.timeline({onComplete:()=>{console.log("Tutorial timeline completed"),window.diatonicCompassTutorial=null}});window.diatonicCompassTutorial=r;const i=n=>{console.log("=== ADDING STEP TO TIMELINE ===",n.text),r.call(async()=>{console.log("=== EXECUTING STEP ===",n.text),r.pause();const s=document.getElementById("tutorial-text"),o=document.getElementById("tutorial-bubble");console.log("Tutorial elements during step execution:",{textEl:!!s,bubbleEl:!!o,textElStyles:s?{opacity:s.style.opacity,visibility:s.style.visibility,display:getComputedStyle(s).display,currentHTML:s.innerHTML}:null,bubbleElStyles:o?{opacity:o.style.opacity,visibility:o.style.visibility,display:getComputedStyle(o).display}:null}),s?(console.log("BEFORE setting text - innerHTML:",s.innerHTML),s.innerHTML=n.text,s.style.opacity="1",s.style.visibility="visible",console.log("AFTER setting text - innerHTML:",s.innerHTML),console.log("Text element computed styles after update:",{opacity:getComputedStyle(s).opacity,visibility:getComputedStyle(s).visibility,display:getComputedStyle(s).display,fontSize:getComputedStyle(s).fontSize,color:getComputedStyle(s).color})):console.error("Tutorial text element not found during step execution!"),n.highlightTarget&&(console.log("Adding highlight to:",n.highlightTarget),go(n.highlightTarget),_o(n.highlightTarget)),console.log("Starting speech synthesis for:",n.text),await fo(n.text),console.log("Speech synthesis completed"),n.waitFor&&(console.log("Waiting for user interaction..."),await n.waitFor(),console.log("User interaction completed")),n.highlightTarget&&(console.log("Removing highlight from:",n.highlightTarget),mo(n.highlightTarget),po()),await new Promise(l=>setTimeout(l,500)),console.log("Step completed, resuming timeline"),r.resume()})};console.log("Adding tutorial mask animation to timeline"),r.to("#tutorial-mask",{autoAlpha:1,duration:.3}),r.call(()=>{console.log("=== SHOWING TUTORIAL BUBBLE ===");const n=document.getElementById("tutorial-bubble"),s=document.getElementById("tutorial-text");console.log("Bubble show elements check:",{bubble:!!n,textEl:!!s,bubbleCurrentStyles:n?{opacity:n.style.opacity,visibility:n.style.visibility,display:getComputedStyle(n).display}:null,textCurrentStyles:s?{opacity:s.style.opacity,visibility:s.style.visibility,innerHTML:s.innerHTML}:null}),n?(console.log("Setting bubble visibility styles"),n.style.display="block",n.style.opacity="1",n.style.visibility="visible",n.setAttribute("aria-hidden","false"),console.log("Bubble styles after setting:",{opacity:n.style.opacity,visibility:n.style.visibility,computedOpacity:getComputedStyle(n).opacity,computedVisibility:getComputedStyle(n).visibility,computedDisplay:getComputedStyle(n).display}),console.log("Tutorial bubble shown successfully")):console.error("Tutorial bubble element not found during show!")}),i({text:"Welcome to the <strong>Diatonic Compass!</strong>"}),i({text:"Rotate the <strong>Pitch</strong> belt so we leave <strong>C Major.</strong>",highlightTarget:".pitch-belt",waitFor:()=>nr("pitchClass")}),i({text:"Nice! <br>Change the <strong>mode</strong> by spinning the <strong>Degree belt.</strong>",highlightTarget:".degree-belt",waitFor:()=>nr("degree")}),i({text:"Wonderful!<br>Now shift the perspective by spinning the <strong>Chromatic belt</strong>.",highlightTarget:".chromatic-belt",waitFor:()=>nr("chromatic")}),r.to("#tutorial-bubble",{bottom:"110px",duration:.3,ease:"power2.out"}),i({text:"Almost there!<br> Tap the <strong>result bar</strong> to <strong>hear your scale.</strong>",highlightTarget:"#result-container",waitFor:async()=>{await new Promise(n=>{const s=()=>m.playback.isPlaying?n():requestAnimationFrame(s);s()}),await new Promise(n=>{const s=()=>m.playback.isPlaying?requestAnimationFrame(s):n();s()})}}),r.to("#tutorial-bubble",{bottom:"20px",duration:.3,ease:"power2.in"}),i({text:"You did it!<br><strong>Enjoy exploring.</strong>"}),r.to(["#tutorial-mask","#tutorial-bubble"],{autoAlpha:0,duration:.4,delay:1}),r.call(()=>{const n=document.getElementById("tutorial-bubble");n&&(n.style.display="none",console.log("Tutorial bubble hidden"))})}function se(a,t){if(m.rings.hasOwnProperty(a)){const e=z(t);m.rings[a]=e}}function wn(a,t,e){const r=t;m.rings.chromatic=z(a.startChrom+r),m.rings.pitchClass=z(a.startPitchClass+t),m.rings.degree=z(a.startDegree+t),m.rings.highlightPosition=z(a.startHighlight+t)}function Cn(a){if(!a)return"#000000";const t=parseInt(a.slice(1,3),16),e=parseInt(a.slice(3,5),16),r=parseInt(a.slice(5,7),16);return .299*t+.587*e+.114*r>140?"#000000":"#FFFFFF"}class bo{constructor(t,e,r){this.canvas=t,this.ctx=t.getContext("2d"),this.state=e,this.onInteractionEnd=r,this._initInteraction()}update(t,e,r){const{size:i,dpr:n}=this.state.dimensions;this._draw(i,n,t,e,r)}_initInteraction(){const t=r=>{const i=this.canvas.getBoundingClientRect(),{cx:n,cy:s,size:o}=this.state.dimensions,l=r.clientX-i.left-n,c=r.clientY-i.top-s,h=Math.hypot(l,c),d=o*.5,f=o*.35,g=o*.2;let p=null;return h>g&&h<f?p="degree":h>f&&h<d?p="pitchClass":h<=g&&(p="chromatic"),{x:l,y:c,ring:p}},e=()=>{if(!this.state.drag.active)return;const r=this.state.drag.active;this.state.drag.active=null,this.canvas.style.cursor="grab",r==="chromatic"?mi(this.onInteractionEnd):r==="pitchClass"?pi("pitchClass",this.onInteractionEnd):r==="degree"&&_i(this.onInteractionEnd)};this.canvas.addEventListener("pointerdown",r=>{const{x:i,y:n,ring:s}=t(r);if(!s)return;const{drag:o,rings:l}=this.state;o.active=s,o.startX=i,o.startY=n,o.startPitchClass=l.pitchClass,o.startDegree=l.degree,o.startChrom=l.chromatic,o.startHighlight=l.highlightPosition,this.canvas.setPointerCapture(r.pointerId),this.canvas.style.cursor="grabbing"}),this.canvas.addEventListener("pointermove",r=>{if(this.state.drag.active){const{x:i,y:n}=t(r),s=this.state.drag,o=Math.atan2(s.startY,s.startX),c=Math.atan2(n,i)-o;s.active==="pitchClass"?se("pitchClass",s.startPitchClass+c):s.active==="degree"?(se("degree",s.startDegree+c),se("highlightPosition",s.startHighlight+c)):s.active==="chromatic"&&wn({startPitchClass:s.startPitchClass,startDegree:s.startDegree,startChrom:s.startChrom,startHighlight:s.startHighlight},c)}else{const{ring:i}=t(r);this.canvas.style.cursor=i?"grab":"default"}}),this.canvas.addEventListener("pointerup",e),this.canvas.addEventListener("pointercancel",e),this.canvas.addEventListener("pointerleave",()=>{this.state.drag.active||(this.canvas.style.cursor="default")})}_draw(t,e,r,i,n){const s=this.ctx;s.save(),s.scale(e,e),s.clearRect(0,0,t,t);const o=t/2,l=t/2,{pitchClass:c,degree:h,chromatic:d}=r,{chromaticLabels:f,diatonicLabels:g}=i,p=(y,C,T)=>{const S=T-V/2,w=T+V/2;s.beginPath(),s.arc(o,l,C,S,w),s.arc(o,l,y,w,S,!0),s.closePath()},u=()=>{const y=t*.5,C=t*.35;Object.keys(fe).forEach((S,w)=>{const A=w*V+c-Math.PI/2;p(C,y,A),s.fillStyle=fe[S]?"#fff":"#000",s.fill(),s.lineWidth=t*.002,s.strokeStyle="#000",s.stroke()})},_=()=>{const y=t*.35,C=t*.2;for(let T=0;T<12;T++){const S=T*V+h-Math.PI/2;p(C,y,S),s.fillStyle=sr[T]||"#e0e0e0",s.fill(),s.lineWidth=t*.002,s.strokeStyle="#000",s.stroke()}},b=()=>{s.beginPath(),s.arc(o,l,t*.2,0,Math.PI*2),s.fillStyle="#000",s.fill()},v=()=>{const y=t*.5*.85,C=t*.35*.8,T=t*.2*.8,S=Object.keys(fe),w=(O,L,B,N,F)=>{s.fillStyle=N,s.font=`${F}px 'Atkinson Hyperlegible Next'`,s.textAlign="center",s.textBaseline="middle";const et=o+Math.cos(O)*L,Ft=l+Math.sin(O)*L;if(String(B).includes("<br>")){const Ot=B.split("<br>"),At=F*1.1,Ct=Ft-At*(Ot.length-1)/2;Ot.forEach((Ee,mt)=>{s.fillText(Ee,et,Ct+mt*At)})}else s.fillText(B,et,Ft)},A=t*Mn;f.forEach((O,L)=>{const B=S[L],N=O,F=fe[B]?"#000":"#fff";w(L*V+c-Math.PI/2,y,N,F,A)});const R=t*In;g.forEach((O,L)=>{const B=sr[L],N=Cn(B),F=O;w(L*V+h-Math.PI/2,C,F,N,R)});const M=t*Dn;En.forEach(O=>w(O*V+d-Math.PI/2,T,O.toString(),"#fff",M))},x=()=>{if(!n||!n.isPlaying||n.currentNoteIndex===null)return;const C=n.currentNoteIndex%12*V+c-Math.PI/2,T=t*.5,S=t*.2;p(S,T,C),s.fillStyle="rgba(255, 255, 0, 0.6)",s.fill()},k=()=>{const y=t*.5,C=t*.125,T=-Math.PI/2+d,S=T-V/2,w=T+V/2;s.beginPath(),s.moveTo(o+Math.cos(S)*C,l+Math.sin(S)*C),s.arc(o,l,y,S,w),s.lineTo(o+Math.cos(w)*C,l+Math.sin(w)*C),s.arc(o,l,C,w,S,!0),s.closePath(),s.lineWidth=t*.006,s.strokeStyle="red",s.stroke()};u(),_(),b(),v(),x(),k(),s.restore()}}class vo{constructor(t,e,r){this.container=t,this.state=e,this.onInteractionEnd=r,this.elements={pitchBelt:t.querySelector("#pitchBelt"),degreeBelt:t.querySelector("#degreeBelt"),chromaticBelt:t.querySelector("#chromaticBelt"),chromaticColorsTrack:t.querySelector("#chromatic-colors-track"),chromaticNumbersTrack:t.querySelector("#chromatic-numbers-track"),intervalBracketsTrackContainer:t.querySelector("#intervalBracketsContainer"),intervalBracketsWrapper:t.querySelector(".interval-brackets-wrapper"),cursor:t.querySelector("#belt-cursor"),flashOverlay:t.querySelector("#belt-flash-overlay")},this.state.belts.tracks={},this._initInteraction()}_calculateRingAngleToBeltPixelsRatio(t){return!t||t<=0?(console.warn("Invalid beltCellWidth for ring-to-belt conversion:",t),0):Tt*t/Vt}update(t,e){const{orientation:r}=this.state.belts,{diatonicLabels:i,chromaticLabels:n}=t;if(!this.state.belts.init){this._setupAllBelts(i,n),requestAnimationFrame(()=>{this._calculateAllBeltCellWidths(r)&&(this.state.belts.init=!0)});return}const{pitchClass:s,degree:o,chromatic:l,highlightPosition:c}=this.state.rings,{tracks:h,itemSize:d}=this.state.belts;this._applyBeltStyles(e,i,n);let f=r==="vertical"?-s:s,g=r==="vertical"?-o:o,p=r==="vertical"?-l:l,u=r==="vertical"?-c:c;this._positionBeltFromRingAngle(h.pitchBelt,f,d.pitchBelt,r),this._positionBeltFromRingAngle(h.degreeBelt,g,d.degreeBelt,r),this._positionBeltFromRingAngle(h.chromaticColors,u,d.chromaticBelt,r),this._positionBeltFromRingAngle(h.chromaticNumbers,p,d.chromaticBelt,r),this._positionIntervalBeltFromDegreeRing(g,d.degreeBelt,r),this._positionBeltCursorFromRingAngle(p,d.chromaticBelt,r),this._updatePlaybackFlashOnBelt()}_initInteraction(){const{pitchBelt:t,degreeBelt:e,intervalBrackets:r,chromaticNumbersTrack:i}=this.elements;t&&this._addDragHandler(t,o=>{const l=this.state.drag.startPitchClass+(this.state.belts.orientation==="vertical"?-o:o);se("pitchClass",l)},()=>pi("pitchClass",this.onInteractionEnd));const n=o=>{const l=this.state.belts.orientation==="vertical"?-o:o;se("degree",this.state.drag.startDegree+l),se("highlightPosition",this.state.drag.startHighlight+l)},s=()=>_i(this.onInteractionEnd);e&&this._addDragHandler(e,n,s),r&&this._addDragHandler(r,n,s),i&&this._addDragHandler(i,o=>{const l=this.state.belts.orientation==="vertical"?-o:o,c={startPitchClass:this.state.drag.startPitchClass,startDegree:this.state.drag.startDegree,startChrom:this.state.drag.startChrom,startHighlight:this.state.drag.startHighlight};wn(c,l)},()=>mi(this.onInteractionEnd))}_addDragHandler(t,e,r){t.style.cursor="grab";let i=null,n=0,s=0;const o=h=>{i=h.pointerId,t.setPointerCapture(i),n=h.clientX,s=h.clientY;const{drag:d,rings:f}=this.state;d.active=t.id||"belt-drag",d.startPitchClass=f.pitchClass,d.startDegree=f.degree,d.startChrom=f.chromatic,d.startHighlight=f.highlightPosition,t.style.cursor="grabbing"},l=h=>{if(i!==h.pointerId)return;const{orientation:d,itemSize:f}=this.state.belts,g=d==="vertical"?h.clientY-s:h.clientX-n;let p;t.id.includes("pitch")?p="pitchBelt":t.id.includes("degree")||t.id.includes("interval")?p="degreeBelt":t.id.includes("chromatic")&&(p="chromaticBelt");const u=f[p];if(!u||u===0)return;const _=g/u*V;e(_)},c=()=>{i!==null&&(t.releasePointerCapture(i),i=null,this.state.drag.active=null,t.style.cursor="grab",r())};t.addEventListener("pointerdown",o),t.addEventListener("pointermove",l),t.addEventListener("pointerup",c),t.addEventListener("pointercancel",c)}_setupAllBelts(t,e){this.elements.pitchBelt.innerHTML="",this.elements.degreeBelt.innerHTML="",this.elements.intervalBracketsTrackContainer.innerHTML="";const r=3;this.state.belts.tracks.pitchBelt=this._createBeltTrack(this.elements.pitchBelt,e,r),this.state.belts.tracks.degreeBelt=this._createBeltTrack(this.elements.degreeBelt,t,r),this._populateBeltTrack(this.elements.chromaticColorsTrack,Array(12).fill(""),r),this._populateBeltTrack(this.elements.chromaticNumbersTrack,[...Array(12).keys()],r),this.state.belts.tracks.chromaticColors=this.elements.chromaticColorsTrack,this.state.belts.tracks.chromaticNumbers=this.elements.chromaticNumbersTrack,this._createIntervalBeltTrack(r)}_createBeltTrack(t,e,r){const i=document.createElement("div");return i.className="belt-track",this._populateBeltTrack(i,e,r),t.appendChild(i),i}_populateBeltTrack(t,e,r){t.innerHTML="";const i=3,n=e.length;for(let s=0;s<r*Tt+i;s++){const o=s%n,l=e[o],c=document.createElement("div");c.className="belt-cell",c.innerHTML=String(l),c.dataset.originalIndex=String(o),t.appendChild(c)}}_createIntervalBeltTrack(t){const e=document.createElement("div");e.className="interval-brackets-track";const r=3;for(let i=0;i<Tt*t+r;i++){const n=i%Tt,s=Le.indexOf(n),o=document.createElement("div");if(o.className="interval-bracket-cell",s!==-1){const l=Pn[s];o.dataset.steps=l,o.innerHTML=`<span>+${l}</span>`}e.appendChild(o)}this.elements.intervalBracketsTrackContainer.appendChild(e)}_calculateAllBeltCellWidths(t){return this._calculateBeltCellWidth("pitchBelt",this.elements.pitchBelt,t)&&this._calculateBeltCellWidth("degreeBelt",this.elements.degreeBelt,t)&&this._calculateBeltCellWidth("chromaticBelt",this.elements.chromaticBelt,t)&&this._calculateBeltCellWidth("intervalBracketsContainer",this.elements.intervalBracketsWrapper,t)}_calculateBeltCellWidth(t,e,r){const i=r==="vertical"?e.offsetHeight:e.offsetWidth;return i>0?(this.state.belts.itemSize[t]=i/Tt,!0):!1}_applyBeltStyles(t,e,r){var i,n,s,o;(i=this.state.belts.tracks.pitchBelt)==null||i.querySelectorAll(".belt-cell").forEach(l=>{const c=+l.dataset.originalIndex,h=De[c],d=fe[h];l.style.background=d?"#fff":"#000",l.style.color=d?"#000":"#fff",l.innerHTML=r[c]}),(n=this.state.belts.tracks.degreeBelt)==null||n.querySelectorAll(".belt-cell").forEach(l=>{const c=+l.dataset.originalIndex,h=sr[c]||"#f0f0f0";l.style.background=h,l.style.color=Cn(h),l.innerHTML=e[c]}),(s=this.elements.chromaticColorsTrack)==null||s.querySelectorAll(".belt-cell").forEach(l=>{const c=+l.dataset.originalIndex;l.style.background=t.includes(c)?"#e0e0e0":"#4a4a4a"}),(o=this.elements.chromaticNumbersTrack)==null||o.querySelectorAll(".belt-cell").forEach(l=>{const{chromatic:c,highlightPosition:h}=this.state.rings,f=z(h-c)/V,g=+l.dataset.originalIndex,p=Math.round((g-f+12*100)%12)%12;l.style.color=t.includes(p)?"black":"lightgray"})}_convertRingAngleToBeltDistance(t,e,r){const i=this._calculateRingAngleToBeltPixelsRatio(e);if(i===0)return 0;const n=t*i;let s,o=0;return r==="vertical"?(s=-(e*Tt),o=3*e,s-o+n):(s=-(e*Tt),s+n)}_positionBeltFromRingAngle(t,e,r,i){if(!t||!r)return;const n=this._convertRingAngleToBeltDistance(e,r,i),s=i==="vertical"?`translateY(${n}px)`:`translateX(${n}px)`;t.style.transform=s}_positionIntervalBeltFromDegreeRing(t,e,r){const i=this.elements.intervalBracketsTrackContainer.querySelector(".interval-brackets-track");if(!i||!e)return;let n=this._convertRingAngleToBeltDistance(t,e,r);r==="horizontal"&&(n+=.5*e);const s=r==="vertical"?`translateY(${n}px)`:`translateX(${n}px)`;i.style.transform=s}_positionBeltCursorFromRingAngle(t,e,r){const i=this.elements.cursor;if(!i||!e)return;const n=this._calculateRingAngleToBeltPixelsRatio(e);if(n===0)return;const s=t*n;let o;if(r==="vertical"){const c=-Tt*e;o=(s%c+c)%c}else o=s;const l=r==="vertical"?`translateY(${o}px)`:`translateX(${o}px)`;i.style.transform=l}_updatePlaybackFlashOnBelt(){const{rings:t,playback:e,belts:r}=this.state,i=this.elements.flashOverlay,n=r.itemSize.chromaticBelt,s=r.orientation;if(!i||!n||!e.isPlaying||e.currentNoteIndex===null){i.style.display="none";return}const o=this._calculateRingAngleToBeltPixelsRatio(n);if(o===0){i.style.display="none";return}let l;if(s==="vertical"){const h=-t.chromatic,d=(e.currentNoteIndex-e.rootNoteIndexForPlayback)*V,g=(h-d)*o,p=-Tt*n;l=(g%p+p)%p}else l=(t.chromatic+(e.currentNoteIndex-e.rootNoteIndexForPlayback)*V)*o;const c=s==="vertical"?`translateY(${l}px)`:`translateX(${l}px)`;i.style.transform=c,i.style.display="block"}}class wo{constructor(){this.container=null,this.draggedItem=null,this.dragOverItem=null,this.onOrderChange=null,this.init()}init(){try{if(this.container=document.getElementById("belt-order-list"),!this.container)throw new Error("Order list container not found");this._setupEventListeners(),this._loadSavedOrder(),this._updateDisplay()}catch(t){E.handle(t,"OrderManager",()=>{console.error("Failed to initialize Order Manager")})}}_setupEventListeners(){this.container.addEventListener("dragstart",this._handleDragStart.bind(this)),this.container.addEventListener("dragover",this._handleDragOver.bind(this)),this.container.addEventListener("dragenter",this._handleDragEnter.bind(this)),this.container.addEventListener("dragleave",this._handleDragLeave.bind(this)),this.container.addEventListener("drop",this._handleDrop.bind(this)),this.container.addEventListener("dragend",this._handleDragEnd.bind(this))}_handleDragStart(t){if(console.log("Drag start event triggered",t.target),!t.target.classList.contains("order-item")){console.log("Not an order-item, ignoring");return}this.draggedItem=t.target,this.draggedItem.classList.add("dragging"),console.log("Dragging item:",this.draggedItem.dataset.component),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/html",this.draggedItem.outerHTML),setTimeout(()=>{this.draggedItem&&(this.draggedItem.style.opacity="0")},1)}_handleDragOver(t){t.preventDefault(),t.dataTransfer.dropEffect="move"}_handleDragEnter(t){t.target.classList.contains("order-item")&&t.target!==this.draggedItem&&(this.dragOverItem=t.target,t.target.classList.add("drag-over"),this._animateReorder(t.target))}_handleDragLeave(t){t.target.classList.contains("order-item")&&t.target.classList.remove("drag-over")}_handleDrop(t){if(t.preventDefault(),console.log("Drop event triggered"),!this.dragOverItem||this.dragOverItem===this.draggedItem){console.log("Drop cancelled - no valid target");return}const e=this.draggedItem.dataset.component,r=this.dragOverItem.dataset.component;console.log(`Dropping ${e} onto ${r}`),this._reorderComponents(e,r),this._saveOrder(),this._updateDisplay(),this._applyComponentOrder()}_handleDragEnd(t){this.draggedItem&&(this.draggedItem.classList.remove("dragging"),this.draggedItem.style.opacity=""),this.container.querySelectorAll(".drag-over").forEach(e=>{e.classList.remove("drag-over")}),this._resetAnimations(),this.draggedItem=null,this.dragOverItem=null}_reorderComponents(t,e){const r=m.belts.orientation,i=[...m.belts.layoutOrder[r]];r==="vertical"?this._reorderVerticalLayout(t,e,i):this._reorderHorizontalLayout(t,e,i)}_reorderHorizontalLayout(t,e,r){const i=r.indexOf(t),n=r.indexOf(e);if(console.log("=== HORIZONTAL REORDER DEBUG ===",{draggedId:t,targetId:e,currentOrder:[...r],draggedIndex:i,targetIndex:n}),i===-1||n===-1){console.log("Invalid indices - horizontal reorder cancelled");return}r.splice(i,1);const s=i<n?n:n+1;console.log("Horizontal reorder calculation:",{afterRemoval:[...r],newTargetIndex:s,calculation:`${i} < ${n} ? ${n} : ${n+1}`,explanation:i<n?"Moving forward: place after target":"Moving backward: place after target"}),r.splice(s,0,t),console.log("Final horizontal order:",[...r]),m.belts.layoutOrder.horizontal=r}_reorderVerticalLayout(t,e,r){if(console.log("=== VERTICAL REORDER DEBUG ===",{draggedId:t,targetId:e,currentOrder:r,isCompassInvolved:t==="compass"||e==="compass"}),t==="compass"||e==="compass"){const i=["intervals","pitch","chromatic","degree"];let n=e,s=t;i.includes(e)&&(n="result",console.log(`Converting belt target '${e}' to 'result'`)),i.includes(t)&&(s="result",console.log(`Converting belt dragged '${t}' to 'result'`));const o=r.indexOf(s),l=r.indexOf(n);if(console.log("Compass reorder indices:",{draggedIndex:o,targetIndex:l,actualDraggedId:s,actualTargetId:n}),o!==-1&&l!==-1&&o!==l){r.splice(o,1);let c;s==="compass"&&i.includes(e)?(c=r.length,console.log("Placing compass after result group at index:",c)):(c=o<l?l:l+1,console.log("Normal reorder to index:",c)),r.splice(c,0,s),m.belts.layoutOrder.vertical=r,console.log("New vertical layout order:",r)}else console.log("Invalid indices or same position - reorder cancelled")}else console.log("Belt reorder within result group"),this._reorderBelts(t,e)}_reorderBelts(t,e){const r=[...m.belts.order],i=r.indexOf(t),n=r.indexOf(e);if(console.log("=== BELT REORDER DEBUG ===",{draggedBelt:t,targetBelt:e,currentOrder:[...r],draggedIndex:i,targetIndex:n}),i===-1||n===-1)return;r.splice(i,1);const s=i<n?n:n+1;console.log("Belt reorder calculation:",{afterRemoval:[...r],newTargetIndex:s,calculation:`${i} < ${n} ? ${n} : ${n+1}`,explanation:i<n?"Moving forward: place after target":"Moving backward: place after target"}),r.splice(s,0,t),console.log("Final belt order:",[...r]),m.belts.order=r}_updateDisplay(){const t=m.belts.orientation;this.container.innerHTML="",t==="horizontal"?this._renderHorizontalLayout():this._renderVerticalLayout()}_renderHorizontalLayout(){m.belts.layoutOrder.horizontal.forEach(e=>{const r=this._createOrderItem(e,this._getComponentLabel(e));this.container.appendChild(r)})}_renderVerticalLayout(){const t=m.belts.layoutOrder.vertical;console.log("=== RENDERING VERTICAL LAYOUT ===",{order:t,beltOrder:m.belts.order}),t.forEach((e,r)=>{if(console.log(`Rendering component ${r}: ${e}`),e==="result"){const i=this._createOrderItem("result","Mode Name",!0);this.container.appendChild(i),console.log("Added result group item"),m.belts.order.forEach((n,s)=>{const o=this._createOrderItem(n,this._getComponentLabel(n),!1,!0);this.container.appendChild(o),console.log(`Added nested belt item ${s}: ${n}`)})}else{const i=this._createOrderItem(e,this._getComponentLabel(e));this.container.appendChild(i),console.log(`Added regular item: ${e}`)}}),console.log("Final sidebar structure:",Array.from(this.container.children).map(e=>({className:e.className,textContent:e.textContent.trim(),dataComponent:e.dataset.component})))}_createOrderItem(t,e,r=!1,i=!1){const n=document.createElement("div");n.className=`order-item${r?" group":""}${i?" nested":""}`,n.draggable=!0,n.dataset.component=t;const s=document.createElement("span");s.className="drag-handle",s.textContent="⋮⋮";const o=document.createElement("span");if(o.className="component-label",o.textContent=e,i){const l=document.createElement("span");l.className="nested-indent",l.textContent="  ",n.appendChild(l)}return n.appendChild(s),n.appendChild(o),n}_getComponentLabel(t){return{compass:"Compass",result:"Mode Name",pitch:"Pitch",degree:"Degrees",intervals:"Intervals",chromatic:"Chromatic"}[t]||t}_saveOrder(){try{const t=Ne();t.layoutOrder=m.belts.layoutOrder,t.beltOrder=m.belts.order,Tr(t)}catch(t){console.warn("Failed to save order preferences:",t)}}_loadSavedOrder(){try{const t=Ne();t&&t.layoutOrder&&(m.belts.layoutOrder=t.layoutOrder),t&&t.beltOrder&&(m.belts.order=t.beltOrder)}catch(t){console.warn("Failed to load order preferences:",t)}}_applyComponentOrder(){this.onOrderChange&&this.onOrderChange(m.belts.layoutOrder,m.belts.order)}setOrderChangeCallback(t){this.onOrderChange=t}onOrientationChange(){this._updateDisplay()}_animateReorder(t){if(!this.draggedItem||!t)return;const e=Array.from(this.container.querySelectorAll(".order-item")),r=e.indexOf(this.draggedItem),i=e.indexOf(t);if(r===-1||i===-1)return;const n=r>i;e.forEach((s,o)=>{if(s===this.draggedItem)return;let l=0;n?o>=i&&o<r&&(l=this.draggedItem.offsetHeight+8):o>r&&o<=i&&(l=-(this.draggedItem.offsetHeight+8)),s.style.transform=`translateY(${l}px)`,s.style.transition="transform 0.2s ease"})}_resetAnimations(){this.container.querySelectorAll(".order-item").forEach(e=>{e.style.transform="",e.style.transition=""})}destroy(){this.container&&(this.container.removeEventListener("dragstart",this._handleDragStart.bind(this)),this.container.removeEventListener("dragover",this._handleDragOver.bind(this)),this.container.removeEventListener("dragenter",this._handleDragEnter.bind(this)),this.container.removeEventListener("dragleave",this._handleDragLeave.bind(this)),this.container.removeEventListener("drop",this._handleDrop.bind(this)),this.container.removeEventListener("dragend",this._handleDragEnd.bind(this)))}}class Co{constructor(t,e,r){this.state=e,this.callbacks=r,this.elements={resultContainer:t.querySelector("#result-container"),resultText:t.querySelector("#result-text"),flatBtn:document.getElementById("flat-btn"),sharpBtn:document.getElementById("sharp-btn"),settingsBtn:document.getElementById("settings-btn"),sidebar:document.getElementById("sidebar"),sidebarOverlay:document.getElementById("sidebar-overlay"),orientationHorizontal:document.getElementById("orientation-horizontal"),orientationVertical:document.getElementById("orientation-vertical"),themeLight:document.getElementById("theme-light"),themeDark:document.getElementById("theme-dark"),startTutorialBtn:document.getElementById("start-tutorial-btn")},this._initListeners(),this._initBeltOrderManager()}_initListeners(){this.elements.flatBtn.addEventListener("click",this.callbacks.onToggleFlat),this.elements.sharpBtn.addEventListener("click",this.callbacks.onToggleSharp),this.elements.resultContainer.addEventListener("click",r=>{r.target.closest("button")||this.callbacks.onTogglePlayback()}),this.elements.settingsBtn.addEventListener("click",r=>{r.stopPropagation(),this.callbacks.onToggleSidebar()}),this.elements.sidebarOverlay.addEventListener("click",()=>{this.state.ui.sidebarOpen&&this.callbacks.onToggleSidebar(!1)}),this.elements.orientationHorizontal.addEventListener("change",()=>{this.elements.orientationHorizontal.checked&&this.callbacks.onToggleOrientation("horizontal")}),this.elements.orientationVertical.addEventListener("change",()=>{this.elements.orientationVertical.checked&&this.callbacks.onToggleOrientation("vertical")}),this.elements.themeLight.addEventListener("change",()=>{this.elements.themeLight.checked&&this.callbacks.onToggleDarkMode(!1)}),this.elements.themeDark.addEventListener("change",()=>{this.elements.themeDark.checked&&this.callbacks.onToggleDarkMode(!0)}),this.elements.startTutorialBtn.addEventListener("click",this.callbacks.onStartTutorial);const t=document.getElementById("orientation-toggle"),e=document.getElementById("theme-toggle");t.addEventListener("click",r=>{console.log("Orientation toggle clicked",r.target);const i=this.elements.orientationHorizontal.checked;console.log("Current orientation horizontal checked:",i),i?(console.log("Switching to vertical"),this.callbacks.onToggleOrientation("vertical")):(console.log("Switching to horizontal"),this.callbacks.onToggleOrientation("horizontal"))}),e.addEventListener("click",r=>{console.log("Theme toggle clicked",r.target);const i=this.elements.themeLight.checked;console.log("Current theme light checked:",i),i?(console.log("Switching to dark mode"),this.callbacks.onToggleDarkMode(!0)):(console.log("Switching to light mode"),this.callbacks.onToggleDarkMode(!1))})}_initBeltOrderManager(){try{this.orderManager=new wo,this.orderManager.setOrderChangeCallback((t,e)=>{this.callbacks.onOrderChange&&this.callbacks.onOrderChange(t,e)})}catch(t){console.warn("Order Manager failed to initialize:",t)}}update(){const{display:t,playback:e,ui:r,belts:i}=this.state,{resultContainer:n,flatBtn:s,sharpBtn:o,resultText:l,sidebar:c,sidebarOverlay:h,settingsBtn:d,orientationHorizontal:f,orientationVertical:g,themeLight:p,themeDark:u}=this.elements;s.classList.toggle("active",t.flat),o.classList.toggle("active",t.sharp),s.setAttribute("aria-pressed",String(t.flat)),o.setAttribute("aria-pressed",String(t.sharp)),n.classList.toggle("playback-active",e.isPlaying),Yn(this.state,l);const _=i.orientation==="horizontal";f.checked=_,g.checked=!_,p.checked=!r.darkMode,u.checked=r.darkMode;const b=r.sidebarOpen;c.classList.toggle("open",b),b?c.removeAttribute("aria-hidden"):c.setAttribute("aria-hidden","true"),h.classList.toggle("visible",b),d.setAttribute("aria-expanded",String(b)),this.orderManager&&this._lastOrientation!==i.orientation&&(this.orderManager.onOrientationChange(),this._lastOrientation=i.orientation)}destroy(){this.orderManager&&(this.orderManager.destroy(),this.orderManager=null)}}class To{constructor(t){this.container=t,this.state=m,this.isInitialized=!1,this.cleanupFunctions=[],this.performanceMonitor=null,this.keyboardManager=null,this.screenReaderManager=null;try{this._initializeApp()}catch(e){E.handle(e,"App",()=>{console.error("Failed to initialize app")})}}_initializeApp(){if(this.elements={canvas:this.container.querySelector("#chromaWheel"),beltsContainer:this.container.querySelector(".belts-container")},!this.elements.canvas)throw new Error("Canvas element not found");if(!this.elements.beltsContainer)throw new Error("Belts container not found");const t={onToggleFlat:E.wrap(()=>{j.toggleAccidental("flat"),this._announceChange(`Flat names ${this.state.display.flat?"enabled":"disabled"}`)},"UI"),onToggleSharp:E.wrap(()=>{j.toggleAccidental("sharp"),this._announceChange(`Sharp names ${this.state.display.sharp?"enabled":"disabled"}`)},"UI"),onToggleDarkMode:E.wrap(e=>{typeof e=="boolean"?this.state.ui.darkMode!==e&&j.toggleDarkMode():j.toggleDarkMode(),this._announceChange(`${this.state.ui.darkMode?"Dark":"Light"} mode enabled`)},"UI"),onTogglePlayback:E.wrap(()=>{j.togglePlayback(),this._announceChange(this.state.playback.isPlaying?"Scale playing":"Playback stopped")},"UI"),onToggleSidebar:E.wrap(e=>{j.toggleSidebar(e),this._announceChange(`Settings ${this.state.ui.sidebarOpen?"opened":"closed"}`)},"UI"),onToggleOrientation:E.wrap(e=>{let r;typeof e=="string"?r=e:r=this.state.belts.orientation==="horizontal"?"vertical":"horizontal",this.state.belts.orientation!==r&&(j.setOrientation(r),this._announceChange(`Layout changed to ${r}`))},"UI"),onStartTutorial:E.wrap(()=>{this._announceChange("Tutorial started"),yo()},"Tutorial"),onShowKeyboardHelp:E.wrap(()=>{this._showKeyboardHelp()},"UI"),onOrderChange:E.wrap((e,r)=>{console.log("Order change triggered:",{layoutOrder:e,beltOrder:r}),this._applyComponentOrder(e,r)},"UI")};try{this.wheel=new bo(this.elements.canvas,this.state,this.onInteractionEnd.bind(this))}catch(e){E.handle(e,"Wheel",()=>{console.error("Wheel component failed to initialize")})}try{this.belts=new vo(this.elements.beltsContainer,this.state,this.onInteractionEnd.bind(this))}catch(e){E.handle(e,"Belts",()=>{console.error("Belts component failed to initialize")})}try{this.uiControls=new Co(this.container,this.state,t)}catch(e){E.handle(e,"UIControls",()=>{console.error("UI Controls failed to initialize")})}this._initializeAccessibility(),this._setupResponsiveLogic();try{Nn(E.wrap(this.redraw.bind(this),"RenderLoop"))}catch(e){E.handle(e,"RenderLoop",()=>{console.error("Render loop failed to start")})}this._isDevelopment()&&this._setupPerformanceMonitoring(),this._setupAccessibilityMonitoring(),this.isInitialized=!0}_initializeAccessibility(){try{this._loadAccessibilityModules().then(()=>{console.log("Accessibility features loaded")}).catch(()=>{console.log("Using basic accessibility features"),this._setupBasicAccessibility()})}catch(t){E.handle(t,"Accessibility",()=>{console.warn("Some accessibility features may not be available"),this._setupBasicAccessibility()})}}async _loadAccessibilityModules(){try{const{KeyboardManager:t}=await Ie(async()=>{const{KeyboardManager:r}=await import("./KeyboardManager-xfwXnrPQ.js");return{KeyboardManager:r}},[],import.meta.url),{ScreenReaderManager:e}=await Ie(async()=>{const{ScreenReaderManager:r}=await import("./ScreenReaderManager-DKGPIayK.js");return{ScreenReaderManager:r}},[],import.meta.url);return t.init(),e.init(),this.keyboardManager=t,this.screenReaderManager=e,!0}catch{throw new Error("Accessibility modules not available")}}_setupBasicAccessibility(){this._setupBasicKeyboard(),this._setupBasicARIA(),this._setupBasicAnnouncements()}_setupBasicKeyboard(){const t=e=>{if(!this._isTextInputActive()&&!(e.ctrlKey||e.altKey||e.metaKey))switch(e.key){case"ArrowLeft":(e.target.id==="chromaWheel"||e.target.closest(".belt"))&&(e.preventDefault(),this._rotateRing("pitchClass",-1),this._announceChange("Pitch ring rotated left"));break;case"ArrowRight":(e.target.id==="chromaWheel"||e.target.closest(".belt"))&&(e.preventDefault(),this._rotateRing("pitchClass",1),this._announceChange("Pitch ring rotated right"));break;case"ArrowUp":(e.target.id==="chromaWheel"||e.target.closest(".belt"))&&(e.preventDefault(),this._rotateRing("pitchClass",1),this._announceChange("Pitch ring rotated up"));break;case"ArrowDown":(e.target.id==="chromaWheel"||e.target.closest(".belt"))&&(e.preventDefault(),this._rotateRing("pitchClass",-1),this._announceChange("Pitch ring rotated down"));break;case" ":case"Enter":!e.target.closest("button")&&!e.target.closest("input")&&!e.target.closest("select")&&(e.preventDefault(),j.togglePlayback());break;case"Escape":j.toggleSidebar(),this._announceChange(this.state.ui.sidebarOpen?"Settings opened":"Settings closed");break;case"f":case"F":e.preventDefault(),j.toggleAccidental("flat"),this._announceChange(`Flat names ${this.state.display.flat?"enabled":"disabled"}`);break;case"s":case"S":e.preventDefault(),j.toggleAccidental("sharp"),this._announceChange(`Sharp names ${this.state.display.sharp?"enabled":"disabled"}`);break;case"v":case"V":e.preventDefault();const r=this.state.belts.orientation==="horizontal"?"vertical":"horizontal";j.setOrientation(r),this._announceChange(`Layout changed to ${r}`);break}};document.addEventListener("keydown",t),this.cleanupFunctions.push(()=>{document.removeEventListener("keydown",t)})}_rotateRing(t,e){const r=e*(Math.PI*2/12),n=(this.state.rings[t]+r)%(Math.PI*2);j.setRingAngle(t,n)}_isTextInputActive(){const t=document.activeElement;return["INPUT","TEXTAREA","SELECT"].includes(t==null?void 0:t.tagName)||(t==null?void 0:t.contentEditable)==="true"}_applyComponentOrder(t,e){console.log("Applying component order:",{layoutOrder:t,beltOrder:e});const r=this.state.belts.orientation,i=t[r];console.log(`Current orientation: ${r}, order:`,i);let n=this.container.querySelector(".main-container");n||(n=document.querySelector(".main-container")),n&&this._restoreOriginalStructure(n),r==="horizontal"?(console.log("Calling _applyHorizontalOrder"),this._applyHorizontalOrder(i)):(console.log("Calling _applyVerticalOrder"),this._applyVerticalOrder(i)),e&&(console.log("Applying belt order:",e),this._applyBeltOrder(e))}_applyHorizontalOrder(t){console.log("_applyHorizontalOrder called with order:",t);let e=this.container.querySelector(".main-container");if(e||(e=document.querySelector(".main-container")),!e){console.log("ERROR: main-container not found anywhere"),console.log("this.container is:",this.container);return}console.log("Container element:",e),console.log("Container classes:",e.className),console.log("Container computed styles before:",{display:getComputedStyle(e).display,flexDirection:getComputedStyle(e).flexDirection,width:getComputedStyle(e).width,height:getComputedStyle(e).height});const r=e.querySelector(".belts-container"),i={compass:e.querySelector(".wheel-container"),result:e.querySelector("#result-container"),pitch:r==null?void 0:r.querySelector(".pitch-belt"),degree:r==null?void 0:r.querySelector(".degree-belt"),intervals:r==null?void 0:r.querySelector(".interval-brackets-wrapper"),chromatic:r==null?void 0:r.querySelector(".chromatic-belt")};console.log("Found components:",Object.keys(i).reduce((o,l)=>(o[l]=!!i[l],o),{})),console.log("Components dimensions before flattening:",{compass:i.compass?{width:i.compass.offsetWidth,height:i.compass.offsetHeight,display:getComputedStyle(i.compass).display}:null,beltsContainer:r?{width:r.offsetWidth,height:r.offsetHeight,display:getComputedStyle(r).display}:null});const n=["pitch","degree","intervals","chromatic"],s=[];n.forEach(o=>{const l=i[o];l&&(l._originalParent=l.parentNode,l._originalNextSibling=l.nextSibling,e.appendChild(l),s.push(l))}),r&&(r.style.display="none"),console.log("After flattening, container children:",Array.from(e.children).map(o=>({tagName:o.tagName,className:o.className,id:o.id,display:getComputedStyle(o).display,flex:getComputedStyle(o).flex,width:o.offsetWidth,height:o.offsetHeight}))),t.forEach((o,l)=>{const c=i[o];c&&(c.style.setProperty("order",l+1,"important"),console.log(`Set order ${l+1} for component:`,o),console.log("Element after order applied:",{width:c.offsetWidth,height:c.offsetHeight,display:getComputedStyle(c).display,flex:getComputedStyle(c).flex,order:getComputedStyle(c).order}))}),console.log("Container computed styles after:",{display:getComputedStyle(e).display,flexDirection:getComputedStyle(e).flexDirection,width:getComputedStyle(e).width,height:getComputedStyle(e).height}),e._isFlattened=!0,e._beltElements=s,e._beltsContainer=r}_applyVerticalOrder(t){let e=this.container.querySelector(".main-container");if(e||(e=document.querySelector(".main-container")),!e)return;this._restoreOriginalStructure(e);const r=t.indexOf("compass"),i=t.indexOf("result");console.log("Vertical layout indices:",{order:t,compassIndex:r,resultIndex:i,compassFirst:r<i}),r>i?(e.style.gridTemplateAreas=`
        "wheel belts"
        "wheel result"
      `,console.log("Applied vertical order: compass left, belts right (compass after result)")):(e.style.gridTemplateAreas=`
        "belts wheel"
        "result wheel"
      `,console.log("Applied vertical order: belts left, compass right (compass before result)"))}_restoreOriginalStructure(t){t._isFlattened&&(console.log("Restoring original DOM structure"),t._beltElements&&t._beltsContainer&&(t._beltElements.forEach(e=>{e.style.removeProperty("order"),e._originalNextSibling?e._originalParent.insertBefore(e,e._originalNextSibling):e._originalParent.appendChild(e),delete e._originalParent,delete e._originalNextSibling}),t._beltsContainer.style.display=""),delete t._isFlattened,delete t._beltElements,delete t._beltsContainer)}_applyBeltOrder(t){const e=this.elements.beltsContainer;if(!e)return;const r={pitch:e.querySelector(".pitch-belt"),degree:e.querySelector(".degree-belt"),intervals:e.querySelector(".interval-brackets-wrapper"),chromatic:e.querySelector(".chromatic-belt")};t.forEach((i,n)=>{const s=r[i];s&&(s.style.setProperty("order",n+1,"important"),console.log(`Set belt order ${n+1} for belt:`,i))})}_setupBasicARIA(){this.container.setAttribute("role","main"),this.container.setAttribute("aria-label","Diatonic Compass Music Theory Tool"),this.elements.canvas&&(this.elements.canvas.setAttribute("tabindex","0"),this.elements.canvas.setAttribute("role","application"),this.elements.canvas.setAttribute("aria-label","Interactive Diatonic Compass - use arrow keys to explore"));const t=document.querySelector("#result-container");t&&(t.setAttribute("tabindex","0"),t.setAttribute("aria-label","Current musical key and mode - click to play"))}_setupBasicAnnouncements(){const t=document.createElement("div");t.id="basic-announcements",t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","false"),t.style.cssText=`
      position: absolute;
      left: -10000px;
      width: 1px;
      height: 1px;
      overflow: hidden;
    `,document.body.appendChild(t),this.cleanupFunctions.push(()=>{t.parentNode&&t.parentNode.removeChild(t)})}_announceChange(t){const e=document.getElementById("basic-announcements");e&&(e.textContent="",setTimeout(()=>{e.textContent=t},100)),this.screenReaderManager&&this.screenReaderManager.queueAnnouncement(t)}_showKeyboardHelp(){const t=`
Keyboard Shortcuts:
- Tab: Navigate between controls
- Arrow keys: Rotate pitch ring (when focused on wheel/belts)
- Ctrl + arrows: Large steps (when focused on wheel/belts)
- Space/Enter: Play scale (when focused on wheel/result)
- F: Toggle flat note names
- S: Toggle sharp note names  
- V: Toggle vertical/horizontal layout
- H: Show this help
- Escape: Open/close settings

Focus the wheel or belts first, then use arrow keys to rotate rings.
    `.trim();alert(t)}_setupAccessibilityMonitoring(){const t=window.matchMedia("(prefers-reduced-motion: reduce)"),e=n=>{document.body.classList.toggle("reduced-motion",n.matches)};t.addListener(e),e(t),this.cleanupFunctions.push(()=>{t.removeListener(e)});const r=window.matchMedia("(prefers-contrast: high)"),i=n=>{document.body.classList.toggle("high-contrast",n.matches)};r.addListener(i),i(r),this.cleanupFunctions.push(()=>{r.removeListener(i)})}onInteractionEnd(){setTimeout(()=>{const t=document.querySelector("#result-text");t&&this._announceChange(`Current key: ${t.textContent}`)},100)}_setupResponsiveLogic(){const t=Zt.debounce(()=>{try{const r=window.innerWidth>window.innerHeight?"vertical":"horizontal";this.state.belts.orientation!==r?(j.setOrientation(r),this._announceChange(`Layout changed to ${r}`)):this.redraw(performance.now())}catch(e){E.handle(e,"Resize",()=>{console.warn("Resize handling failed")})}},150);window.addEventListener("resize",t),this.cleanupFunctions.push(()=>{window.removeEventListener("resize",t),t.cancel()});try{const r=window.innerWidth>window.innerHeight?"vertical":"horizontal";j.setOrientation(r)}catch(e){E.handle(e,"Resize")}}_setupPerformanceMonitoring(){if(this.performanceMonitor=Zt.createFPSMonitor(t=>{t<30&&console.warn(`Low FPS detected: ${t}`)},120),Zt.getMemoryInfo()){const t=setInterval(()=>{const e=Zt.getMemoryInfo();e&&e.used>100&&console.warn(`High memory usage: ${e.used}MB`)},3e4);this.cleanupFunctions.push(()=>clearInterval(t))}this.cleanupFunctions.push(()=>{this.performanceMonitor&&(this.performanceMonitor(),this.performanceMonitor=null)})}redraw(t){try{Gn(t);const e=Fn(this.elements.canvas,this.state.dimensions);if(!this.state.dimensions.size)return;const r=fi(this.state),{rings:i,playback:n}=this.state,s=Le;if(this.wheel)try{this.wheel.update(i,r,n)}catch(o){E.handle(o,"Wheel",()=>{console.warn("Wheel update failed - skipping frame")})}if(this.belts)try{this.belts.update(r,s)}catch(o){E.handle(o,"Belts",()=>{console.warn("Belts update failed - skipping frame")})}if(this.uiControls)try{this.uiControls.update()}catch(o){E.handle(o,"UIControls",()=>{console.warn("UI Controls update failed - skipping frame")})}}catch(e){E.handle(e,"RenderLoop",()=>{console.error("Critical render error - app may be unstable")})}}destroy(){try{this.keyboardManager,this.screenReaderManager&&this.screenReaderManager.cleanup(),this.cleanupFunctions.forEach(t=>{try{t()}catch(e){console.warn("Cleanup function failed:",e)}}),this.cleanupFunctions=[],this.wheel&&typeof this.wheel.destroy=="function"&&this.wheel.destroy(),this.belts&&typeof this.belts.destroy=="function"&&this.belts.destroy(),this.uiControls&&typeof this.uiControls.destroy=="function"&&this.uiControls.destroy(),this.performanceMonitor&&(this.performanceMonitor(),this.performanceMonitor=null),this.isInitialized=!1}catch(t){E.handle(t,"App",()=>{console.error("App cleanup failed")})}}_isDevelopment(){return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.protocol==="file:"}getStatus(){var t,e;return{initialized:this.isInitialized,components:{wheel:!!this.wheel,belts:!!this.belts,uiControls:!!this.uiControls},accessibility:{keyboardEnabled:(t=this.keyboardManager)==null?void 0:t.isEnabled,screenReaderEnabled:(e=this.screenReaderManager)==null?void 0:e.isEnabled},dimensions:this.state.dimensions,errors:E.getErrorLog()}}}function xo(){const a=Ne();if(a&&(typeof a.darkMode=="boolean"&&(m.ui.darkMode=a.darkMode,document.body.classList.toggle("dark-mode",a.darkMode)),Array.isArray(a.beltOrder))){const t=["pitch","degree","intervals","chromatic"];if(t.every(r=>a.beltOrder.includes(r))&&a.beltOrder.length===t.length){m.belts.order=a.beltOrder;const r=document.querySelector(".belts-container");if(r){const i={pitch:".pitch-belt",degree:".degree-belt",intervals:".interval-brackets-wrapper",chromatic:".chromatic-belt"};a.beltOrder.forEach((n,s)=>{const o=i[n];if(o){const l=r.querySelector(o);l&&(l.style.order=s+1)}})}}}}document.addEventListener("DOMContentLoaded",()=>{xo();const a=document.querySelector(".main-container");a&&new To(a)});export{j as A,Q as C,E,m as a,fi as b,ko as g,z as n};
