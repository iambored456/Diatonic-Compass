(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();const n={rings:{pitchClass:0,degree:0,chromatic:0,highlightPosition:0},drag:{active:null,startX:0,startY:0,startPitchClass:0,startDegree:0,startChrom:0,startHighlight:0},belts:{itemSize:{},tracks:{},init:!1,orientation:"horizontal"},dimensions:{size:0,cx:0,cy:0,dpr:1},animation:null,playback:{isPlaying:!1,currentNoteIndex:null,sequence:[],timeoutId:null,audioContext:null,rootNoteIndexForPlayback:null},display:{sharp:!0,flat:!0}},j=["C","C♯/D♭","D","D♯/E♭","E","F","F♯/G♭","G","G♯/A♭","A","A♯/B♭","B"],Q=["1","♯1/♭2","2","♯2/♭3","3","4","♯4/♭5","5","♯5/♭6","6","♯6/♭7","7"],pt=[...Array(12).keys()],F=[0,2,4,5,7,9,11],M={C:!0,"C♯/D♭":!1,D:!0,"D♯/E♭":!1,E:!0,F:!0,"F♯/G♭":!1,G:!0,"G♯/A♭":!1,A:!0,"A♯/B♭":!1,B:!0},Y={0:"#f090ae",2:"#ea9e5e",4:"#a8bd61",5:"#76c788",7:"#33c6dc",9:"#94adff",11:"#dd95d6",1:"#a46055",3:"#8a722f",6:"#258677",8:"#3d7ca5",10:"#7d68a3"},yt={1:[0,2,4,5,7,9,11],2:[0,2,3,5,7,9,10],3:[0,1,3,5,7,8,10],4:[0,2,4,6,7,9,11],5:[0,2,4,5,7,9,10],6:[0,2,3,5,7,8,10],7:[0,1,3,5,6,8,10]},rt={1:"1","♯1/♭2":"2",2:"2","♯2/♭3":"3",3:"3",4:"4","♯4/♭5":"5",5:"5","♯5/♭6":"6",6:"6","♯6/♭7":"7",7:"7"},bt={1:"Major",2:"Dorian",3:"Phrygian",4:"Lydian",5:"Mixolydian",6:"Minor",7:"Locrian"},Ct=[2,2,1,2,2,2,1],A=Math.PI*2,y=A/12,It=.042,Pt=300,vt=45,nt=250,Et=50,Bt=261.63,kt=1/y,m=t=>(t%A+A)%A;function st(t,e){const r=m(e)-m(t);return r>Math.PI?r-A:r<-Math.PI?r+A:r}const At=t=>t<.5?2*t*t:-1+(4-2*t)*t,H=t=>(Math.round(-m(t)*kt)%12+12)%12;function at(t){if(!t)return"#000000";const e=parseInt(t.slice(1,3),16),r=parseInt(t.slice(3,5),16),o=parseInt(t.slice(5,7),16);return .299*e+.587*r+.114*o>140?"#000000":"#FFFFFF"}function Tt(t,e,r,{pitchClass:o,degree:i,chromatic:s},{chromaticLabels:a,diatonicLabels:c},l){t.save(),t.scale(r,r),t.clearRect(0,0,e,e);const d=e/2,u=e/2;h(),f(),P(),E(a,c),T(),D(),t.restore();function g(b,p,C){const I=C-y/2,B=C+y/2;t.beginPath(),t.arc(d,u,p,I,B),t.arc(d,u,b,B,I,!0),t.closePath()}function h(){const b=e*.5,p=e*.35;Object.keys(M).forEach((I,B)=>{const $=B*y+o-Math.PI/2;g(p,b,$),t.fillStyle=M[I]?"#fff":"#000",t.fill(),t.lineWidth=e*.002,t.strokeStyle="#000",t.stroke()})}function f(){const b=e*.35,p=e*.2;for(let C=0;C<12;C++){const I=C*y+i-Math.PI/2;g(p,b,I),t.fillStyle=Y[C]||"#e0e0e0",t.fill(),t.lineWidth=e*.002,t.strokeStyle="#000",t.stroke()}}function P(){t.beginPath(),t.arc(d,u,e*.2,0,Math.PI*2),t.fillStyle="#000",t.fill()}function v(b,p,C,I){t.fillStyle=I,t.font=`${e*It}px 'Atkinson Hyperlegible Next'`,t.textAlign="center",t.textBaseline="middle",t.fillText(C,d+Math.cos(b)*p,u+Math.sin(b)*p)}function E(b,p){const C=e*.5*.85,I=e*.35*.8,B=e*.2*.8,$=Object.keys(M);b.forEach((N,L)=>{const G=$[L],V=String(N).replace("<br>","/");v(L*y+o-Math.PI/2,C,V,M[G]?"#000":"#fff")}),p.forEach((N,L)=>{const G=Y[L],V=at(G),mt=String(N).replace("<br>","/");v(L*y+i-Math.PI/2,I,mt,V)}),pt.forEach(N=>v(N*y+s-Math.PI/2,B,N.toString(),"#fff"))}function T(){if(!l||!l.isPlaying||l.currentNoteIndex===null)return;const p=l.currentNoteIndex%12*y+o-Math.PI/2,C=e*.5,I=e*.2;g(I,C,p),t.fillStyle="rgba(255, 255, 0, 0.6)",t.fill()}function D(){const b=e*.5,p=e*.125,C=-Math.PI/2+s,I=C-y/2,B=C+y/2;t.beginPath(),t.moveTo(d+Math.cos(I)*p,u+Math.sin(I)*p),t.arc(d,u,b,I,B),t.lineTo(d+Math.cos(B)*p,u+Math.sin(B)*p),t.arc(d,u,p,B,I,!0),t.closePath(),t.lineWidth=e*.006,t.strokeStyle="red",t.stroke()}}function J(t,e=null){const r=performance.now(),o={fromPitchClass:n.rings.pitchClass,fromDegree:n.rings.degree,fromChrom:n.rings.chromatic,fromHighlight:n.rings.highlightPosition},i={toPitchClass:t.pitchClass??o.fromPitchClass,toDegree:t.degree??o.fromDegree,toChrom:t.chromatic??o.fromChrom,toHighlight:t.highlightPosition??o.fromHighlight};console.log("[Animation] Starting snap.",{from:o,to:i}),n.animation={t0:r,from:o,to:i,onComplete:e}}function Dt(t){const e=n.animation;if(!e)return!1;const r=(t-e.t0)/Pt,o=r>=1?1:At(r),i=(s,a)=>m(s+st(s,a)*o);return n.rings.pitchClass=i(e.from.fromPitchClass,e.to.toPitchClass),n.rings.degree=i(e.from.fromDegree,e.to.toDegree),n.rings.chromatic=i(e.from.fromChrom,e.to.toChrom),n.rings.highlightPosition=i(e.from.fromHighlight,e.to.toHighlight),o===1&&(console.log("[Animation] Snap completed."),e.onComplete&&e.onComplete(),n.animation=null),!0}function ct(t,e){console.log(`[Animation] Snapping ring: ${t}`);const r=n.rings[t],o=Math.round(-r/y),i=m(-o*y);J({[t]:i},e)}function lt(t){console.log("[Animation] Snapping degree ring to nearest diatonic interval.");const{degree:e,chromatic:r}=n.rings,o=m(e-r),i=m(-o)/y;let s=F[0],a=1/0;F.forEach(d=>{const u=Math.abs(i-d),g=Math.min(u,12-u);g<a&&(a=g,s=d)});const c=m(-s*y),l=m(c+r);J({degree:l,highlightPosition:l},t)}function dt(t){console.log("[Animation] Snapping all rings after chromatic drag.");const e=Math.round(-n.rings.chromatic/y),r=m(-e*y),o=st(n.rings.chromatic,r),i=m(n.rings.pitchClass+o),s=m(n.rings.degree-n.rings.chromatic),a=m(s+r);J({pitchClass:i,degree:a,chromatic:r,highlightPosition:a},t)}function k(t,e){if(n.rings.hasOwnProperty(t)){const r=m(e);n.rings[t]=r}}function X(t,e,r){const o=e;n.rings.chromatic=m(t.startChrom+o),n.rings.pitchClass=m(t.startPitchClass+e),n.rings.degree=m(t.startDegree+e),n.rings.highlightPosition=m(t.startHighlight+e)}function Nt(t,e){const r=i=>{const s=t.getBoundingClientRect(),a=i.clientX-s.left-n.dimensions.cx,c=i.clientY-s.top-n.dimensions.cy,l=Math.hypot(a,c),d=n.dimensions.size,u=d*.5,g=d*.35,h=d*.2;let f=null;return l>h&&l<g?f="degree":l>g&&l<u?f="pitchClass":l<=h&&(f="chromatic"),{x:a,y:c,ring:f}};t.addEventListener("pointerdown",i=>{const{x:s,y:a,ring:c}=r(i);c&&(n.drag.active=c,n.drag.startX=s,n.drag.startY=a,n.drag.startPitchClass=n.rings.pitchClass,n.drag.startDegree=n.rings.degree,n.drag.startChrom=n.rings.chromatic,n.drag.startHighlight=n.rings.highlightPosition,t.setPointerCapture(i.pointerId),t.style.cursor="grabbing")}),t.addEventListener("pointermove",i=>{if(n.drag.active){const{x:s,y:a}=r(i),c=n.drag,l=Math.atan2(c.startY,c.startX),u=Math.atan2(a,s)-l;c.active==="pitchClass"?k("pitchClass",c.startPitchClass+u):c.active==="degree"?(k("degree",c.startDegree+u),k("highlightPosition",c.startHighlight+u)):c.active==="chromatic"&&X({startPitchClass:c.startPitchClass,startDegree:c.startDegree,startChrom:c.startChrom,startHighlight:c.startHighlight},u)}else{const{ring:s}=r(i);t.style.cursor=s?"grab":"default"}});const o=()=>{if(!n.drag.active)return;const i=n.drag.active;n.drag.active=null,t.style.cursor="grab",i==="chromatic"?dt(e):i==="pitchClass"?ct("pitchClass",e):i==="degree"&&lt(e)};t.addEventListener("pointerup",o),t.addEventListener("pointercancel",o),t.addEventListener("pointerleave",()=>{n.drag.active||(t.style.cursor="default")})}function w(t,e,r){t.style.cursor="grab";let o=null,i=0,s=0,a={};const c=d=>{o=d.pointerId,t.setPointerCapture(o),i=d.clientX,s=d.clientY,a={pitchClass:n.rings.pitchClass,degree:n.rings.degree,chromatic:n.rings.chromatic,highlight:n.rings.highlightPosition},t.style.cursor="grabbing",n.drag.active=t.id||"unknown"},l=()=>{o!==null&&(t.releasePointerCapture(o),o=null,t.style.cursor="grab",n.drag.active=null,r())};t.addEventListener("pointerdown",c),t.addEventListener("pointermove",d=>{if(o!==d.pointerId)return;const{orientation:u}=n.belts,g=u==="vertical"?d.clientY-s:d.clientX-i;console.log(`[Gesture] Orientation: ${u}, deltaPos: ${g.toFixed(2)}`);const h=t.closest(".belt, .interval-brackets-container"),f=n.belts.itemSize[h.id];if(!f||f===0)return;const P=g/f*y;e(P,a)}),t.addEventListener("pointerup",l),t.addEventListener("pointercancel",l)}function Lt(t){console.log("[Interaction] Initializing belt handlers.");const e=document.getElementById("pitchBelt");e&&w(e,(c,l)=>{n.belts.orientation==="vertical"?(console.log("[Data Flow] Vertical Pitch Belt: Inverting delta for wheel rotation."),k("pitchClass",l.pitchClass-c)):(console.log("[Data Flow] Horizontal Pitch Belt: Directly updating wheel rotation."),k("pitchClass",l.pitchClass+c))},()=>ct("pitchClass",t));const r=(c,l)=>{n.belts.orientation==="vertical"?(console.log("[Data Flow] Vertical Degree Belt: Inverting delta for wheel rotation."),k("degree",l.degree-c),k("highlightPosition",l.highlight-c)):(console.log("[Data Flow] Horizontal Degree Belt: Directly updating wheel rotation."),k("degree",l.degree+c),k("highlightPosition",l.highlight+c))},o=()=>lt(t),i=document.getElementById("degreeBelt");i&&w(i,r,o);const s=document.getElementById("intervalBracketsContainer");s&&w(s,r,o);const a=document.getElementById("chromatic-numbers-track");a&&w(a,(c,l)=>{const d={startPitchClass:l.pitchClass,startDegree:l.degree,startChrom:l.chromatic,startHighlight:l.highlight};n.belts.orientation==="vertical"?(console.log("[Data Flow] Vertical Chromatic Belt: Inverting co-rotation delta."),X(d,-c)):(console.log("[Data Flow] Horizontal Chromatic Belt: Directly co-rotating."),X(d,c))},()=>dt(t))}function Mt(t){function e(r){Dt(r),t(),requestAnimationFrame(e)}requestAnimationFrame(e)}function W(t,e,r){t.innerHTML="";const o=e.length;for(let i=0;i<r*12+3;i++){const s=i%o,a=e[s],c=document.createElement("div");c.className="belt-cell",c.innerHTML=String(a),c.dataset.originalIndex=String(s),t.appendChild(c)}}function ot(t,e,r){const o=document.createElement("div");return o.className="belt-track",W(o,e,r),t.appendChild(o),o}function Ot(t,e,r=3){console.log("[Belts] Setting up belt content for the first time.");const o=document.getElementById("pitchBelt");o&&(o.innerHTML="",n.belts.tracks.pitchBelt=ot(o,e,r));const i=document.getElementById("degreeBelt");i&&(i.innerHTML="",n.belts.tracks.degreeBelt=ot(i,t,r));const s=document.getElementById("chromatic-colors-track");s&&(W(s,Array(12).fill(""),r),n.belts.tracks.chromaticColors=s);const a=document.getElementById("chromatic-numbers-track");a&&(W(a,[...Array(12).keys()],r),n.belts.tracks.chromaticNumbers=a)}function St(t,e,r){var c,l,d,u;const o=(c=n.belts.tracks.pitchBelt)==null?void 0:c.querySelectorAll(".belt-cell");o==null||o.forEach(g=>{const h=+g.dataset.originalIndex,f=j[h],P=M[f];g.style.background=P?"#fff":"#000",g.style.color=P?"#000":"#fff",g.innerHTML=r[h]});const i=(l=n.belts.tracks.degreeBelt)==null?void 0:l.querySelectorAll(".belt-cell");i==null||i.forEach(g=>{const h=+g.dataset.originalIndex,f=Y[h]||"#f0f0f0";g.style.background=f,g.style.color=at(f),g.innerHTML=e[h]});const s=(d=n.belts.tracks.chromaticColors)==null?void 0:d.querySelectorAll(".belt-cell");s&&s.forEach(g=>{const h=+g.dataset.originalIndex,f=t.includes(h);g.style.background=f?"#e0e0e0":"#4a4a4a"});const a=(u=n.belts.tracks.chromaticNumbers)==null?void 0:u.querySelectorAll(".belt-cell");if(a){const{chromatic:g,highlightPosition:h}=n.rings,P=m(h-g)/y;a.forEach(v=>{const T=(+v.dataset.originalIndex-P+12*100)%12,D=Math.round(T)%12,b=t.includes(D);v.style.color=b?"black":"lightgray"})}}function q(t,e,r){r==="vertical"?t.style.transform=`translateY(${e}px)`:t.style.transform=`translateX(${e}px)`}function gt(t,e,r){const o=12*e/A,i=t*o;let s;if(r==="vertical"){const a=-(e*12),c=3*e;s=a-c+i}else s=-(e*12)+i;return s}function x(t,e,r,o){if(!t||!r)return;const i=gt(e,r,o);q(t,i,o)}function wt(t,e,r){const o=document.querySelector("#intervalBracketsContainer .interval-brackets-track");if(!o||!e)return;let i=gt(t,e,r);r==="horizontal"&&(i+=.5*e),q(o,i,r)}function R(t,e,r){const o=r==="vertical"?e.offsetHeight:e.offsetWidth;return o>0?(n.belts.itemSize[t]=o/12,!0):!1}function xt(t,e,r){const o=document.getElementById("belt-cursor");if(!o||!e)return;const i=12*e/A,s=t*i;let a;if(r==="vertical"){const c=-(0*e),l=-12*e,d=(s%l+l)%l;a=c+d}else a=-(e*0)+s;q(o,a,r)}function Rt(t,e,r,o){const i=document.getElementById("belt-flash-overlay");if(!(!i||!r))if(e.isPlaying&&e.currentNoteIndex!==null&&e.rootNoteIndexForPlayback!==null){const s=12*r/A;let a;if(o==="vertical"){const c=-t.chromatic,l=(e.currentNoteIndex-e.rootNoteIndexForPlayback)*y,u=(c-l)*s,g=-12*r;a=(u%g+g)%g}else a=(t.chromatic+(e.currentNoteIndex-e.rootNoteIndexForPlayback)*y)*s;q(i,a,o),i.style.display="block"}else i.style.display="none"}function Ft(t,e,r){const{orientation:o}=n.belts;if(!n.belts.init){Ot(t,e,3);const P=document.getElementById("intervalBracketsContainer");if(P){P.innerHTML="";const v=document.createElement("div");v.className="interval-brackets-track";for(let E=0;E<12*3+3;E++){const T=E%12,D=F.indexOf(T),b=document.createElement("div");if(b.className="interval-bracket-cell",D!==-1){const p=Ct[D];b.dataset.steps=p,b.innerHTML=`<span>+${p}</span>`}v.appendChild(b)}P.appendChild(v)}requestAnimationFrame(()=>{R("pitchBelt",document.getElementById("pitchBelt"),o)&&R("degreeBelt",document.getElementById("degreeBelt"),o)&&R("chromaticBelt",document.getElementById("chromaticBelt"),o)&&R("intervalBracketsContainer",document.getElementById("intervalBracketsContainer"),o)&&(n.belts.init=!0,console.log("[Belts] All belt item sizes calculated and initialized."))});return}const{pitchClass:i,degree:s,chromatic:a,highlightPosition:c}=n.rings,{tracks:l,itemSize:d}=n.belts;St(r,t,e);let u=i,g=s,h=a,f=c;o==="vertical"&&(u=-i,g=-s,h=-a,f=-c),x(l.pitchBelt,u,d.pitchBelt,o),x(l.degreeBelt,g,d.degreeBelt,o),wt(g,d.degreeBelt,o),x(l.chromaticColors,f,d.chromaticBelt,o),x(l.chromaticNumbers,h,d.chromaticBelt,o),xt(h,d.chromaticBelt,o)}function Ht(){if(n.playback.audioContext)return;const t=window.AudioContext||window.webkitAudioContext;n.playback.audioContext=new t,n.playback.audioContext.state==="suspended"&&n.playback.audioContext.resume()}function _t(t,e){const r=n.playback.audioContext;if(!r)return;const o=r.createOscillator(),i=r.createGain(),s=Bt*Math.pow(2,t/12);o.frequency.setValueAtTime(s,r.currentTime),o.type="sine",o.connect(i),i.connect(r.destination),i.gain.setValueAtTime(0,r.currentTime),i.gain.linearRampToValueAtTime(.5,r.currentTime+.01),i.gain.linearRampToValueAtTime(0,r.currentTime+e),o.start(r.currentTime),o.stop(r.currentTime+e)}function qt(){const{pitchClass:t,degree:e,chromatic:r}=n.rings,o=H(m(t-r)),i=H(m(e-r)),s=Q[i],a=rt[s];if(!a)return[];const l=yt[a].map(d=>o+d);return l.push(l[0]+12),console.log("[Playback] Calculated scale sequence:",{scale:l,rootNoteIndex:o,modeKey:a}),l}function ut(){if(!n.playback.isPlaying){U(!1);return}const t=n.playback.sequence;if(t.length===0){U();return}const e=t.shift();n.playback.currentNoteIndex=e,console.log(`[Playback] Playing note: ${e%12} (raw index: ${e})`),_t(e,nt/1e3);const r=setTimeout(ut,nt+Et);n.playback.timeoutId=r}function $t(){if(n.playback.isPlaying)return;console.log("[Playback] Starting playback."),Ht();const t=qt();if(t.length===0){console.warn("[Playback] Could not start playback, no valid scale sequence found.");return}n.playback.rootNoteIndexForPlayback=t[0],n.playback.isPlaying=!0,n.playback.sequence=t,document.getElementById("result-container").classList.add("playback-active"),ut()}function U(t=!0){!n.playback.isPlaying&&t||(n.playback.isPlaying&&console.log("[Playback] Stopping playback."),clearTimeout(n.playback.timeoutId),n.playback.isPlaying=!1,n.playback.currentNoteIndex=null,n.playback.sequence=[],n.playback.timeoutId=null,n.playback.rootNoteIndexForPlayback=null,t&&document.getElementById("result-container").classList.remove("playback-active"))}console.log("Diatonic Compass Initializing...");const Gt=document.querySelector(".main-container"),O=document.getElementById("chromaWheel"),Vt=document.getElementById("result-container"),it=document.getElementById("result-text"),z=document.getElementById("flat-btn"),K=document.getElementById("sharp-btn"),_=document.getElementById("settings-btn"),S=document.getElementById("sidebar"),Z=document.getElementById("sidebar-overlay"),Yt=document.getElementById("toggle-orientation-btn");n.dimensions={size:0,cx:0,cy:0,dpr:window.devicePixelRatio||1};function Xt(){const{sharp:t,flat:e}=n.display,{orientation:r,itemSize:o}=n.belts,i=o.pitchBelt||0,s=r==="vertical"||i>0&&i<vt,a=d=>{if(!d.includes("/"))return d;const[u,g]=d.split("/");return s?t&&e?`${u}<br>${g}`:t?u:e?g:`${u}<br>${g}`:t&&e?d:t?u:e?g:u},c=j.map(a),l=Q.map(a);return{chromaticLabels:c,diatonicLabels:l}}function tt(){const{sharp:t,flat:e}=n.display,r=E=>{if(!E.includes("/"))return E;const[T,D]=E.split("/");return t&&e?E:t?T:e?D:T},o=j.map(r),{pitchClass:i,degree:s,chromatic:a}=n.rings,c=m(i-a),l=m(s-a),d=H(c),u=H(l),g=o[d],h=Q[u],f=rt[h]||null,P=f?bt[f]:"...",v=`${g} ${P}`;it.textContent!==v&&(it.textContent=v)}function ft(t){if(n.display[t]=!n.display[t],!n.display.sharp&&!n.display.flat){const e=t==="sharp"?"flat":"sharp";n.display[e]=!0}tt()}Vt.addEventListener("click",t=>{t.target.closest("button")||(n.playback.isPlaying?U():!n.drag.active&&!n.animation&&$t())});z.addEventListener("click",()=>ft("flat"));K.addEventListener("click",()=>ft("sharp"));function ht(){tt()}function Wt(){S.classList.add("open"),S.setAttribute("aria-hidden","false"),Z.classList.add("visible"),_.setAttribute("aria-expanded","true")}function et(){_.focus(),S.classList.remove("open"),S.setAttribute("aria-hidden","true"),Z.classList.remove("visible"),_.setAttribute("aria-expanded","false")}function Ut(){console.log("[Main] Toggling belt orientation.");const t=n.belts.orientation==="horizontal"?"vertical":"horizontal";n.belts.orientation=t,console.log(`[State] Belt orientation set to: ${t}`),n.rings.pitchClass=0,n.rings.degree=0,n.rings.chromatic=0,n.rings.highlightPosition=0,console.log("[State] Resetting ring positions to 0 for orientation change."),Gt.classList.toggle("vertical-layout",t==="vertical"),n.belts.init=!1,console.log("[Belts] Belt initialization reset for recalculation."),et()}_.addEventListener("click",t=>{t.stopPropagation(),S.classList.contains("open")?et():Wt()});Z.addEventListener("click",et);Yt.addEventListener("click",Ut);Nt(O,ht);Lt(ht);function zt(){const{dpr:t}=n.dimensions,e=O.offsetWidth;e!==n.dimensions.size&&(console.log(`[Canvas] Resizing from ${n.dimensions.size}px to ${e}px`),n.dimensions.size=e,n.dimensions.cx=e/2,n.dimensions.cy=e/2,O.width=e*t,O.height=e*t,n.belts.init=!1)}function Kt(){zt();const{size:t,dpr:e}=n.dimensions;if(!t)return;const{rings:r,playback:o,belts:i}=n,{chromaticLabels:s,diatonicLabels:a}=Xt(),c=F;z.classList.toggle("active",n.display.flat),K.classList.toggle("active",n.display.sharp),z.setAttribute("aria-pressed",String(n.display.flat)),K.setAttribute("aria-pressed",String(n.display.sharp));const l=O.getContext("2d");Tt(l,t,e,r,{chromaticLabels:s,diatonicLabels:a},o),Ft(a,s,c);const d=i.itemSize.chromaticBelt,u=i.orientation;Rt(r,o,d,u),tt()}console.log("[Main] Starting render loop.");Mt(Kt);
